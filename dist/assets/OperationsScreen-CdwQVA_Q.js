import{r,j as e,I as z,T as Ce,R as Ee,b as be,c as je,O as Ie}from"./index-CE1MFFCv.js";import{M as Te}from"./Modal-dsQ9zPJa.js";const Pe=[{label:"L",value:"1"},{label:"M",value:"2"},{label:"M",value:"3"},{label:"J",value:"4"},{label:"V",value:"5"},{label:"S",value:"6"},{label:"D",value:"0"}],$e=({isOpen:t,onClose:b,onSave:j,onDelete:R,task:s,selectedDate:E,users:P,editMode:N,isSaving:k,allTasks:W})=>{const[C,L]=r.useState(""),[D,B]=r.useState(""),[d,O]=r.useState("08"),[A,Y]=r.useState("00"),[I,H]=r.useState("AM"),[_,F]=r.useState("30"),[ee,Z]=r.useState("pre-apertura"),[o,c]=r.useState(""),[i,w]=r.useState(!1),[G,J]=r.useState(""),[S,te]=r.useState("once"),[le,n]=r.useState([]),[g,x]=r.useState("4"),[p,v]=r.useState([]),[l,M]=r.useState(""),[u,f]=r.useState(E),[m,y]=r.useState(!0),[K,U]=r.useState("");r.useEffect(()=>{if(t){const a=P.length>0?P[0].name:"";y(!!(s!=null&&s.date)||N==="new"),L((s==null?void 0:s.text)||""),B((s==null?void 0:s.employee)||a),U((s==null?void 0:s.addedBy)||a),f((s==null?void 0:s.date)||E);const T=(s==null?void 0:s.time)||"08:00",[X,h]=T.split(":").map(Number),ue=X>=12?"PM":"AM";let ie=X%12;if(ie===0&&(ie=12),O(String(ie).padStart(2,"0")),Y(String(h).padStart(2,"0")),H(ue),F(String((s==null?void 0:s.duration)||"30")),Z((s==null?void 0:s.shift)||"pre-apertura"),c((s==null?void 0:s.zone)||""),w((s==null?void 0:s.isCritical)||!1),J((s==null?void 0:s.notes)||""),v((s==null?void 0:s.subtasks)||[]),M(""),s&&N==="future"&&s.recurrenceId){te("weekly");const se=W.filter(q=>q.recurrenceId===s.recurrenceId),ce=new Set;se.forEach(q=>{if(q.date){const $=new Date(q.date);$.setMinutes($.getMinutes()+$.getTimezoneOffset());const de=$.getDay();ce.add(String(de))}}),n(Array.from(ce))}else te("once"),n([]);x("4")}},[t,s,P,E,N,W]);const Q=a=>{n(T=>T.includes(a)?T.filter(X=>X!==a):[...T,a])},ae=()=>{if(l.trim()==="")return;const a={id:`sub-${Date.now()}`,text:l.trim(),isCompleted:!1};v([...p,a]),M("")},he=a=>{a.key==="Enter"&&(a.preventDefault(),ae())},ye=a=>{v(p.filter(T=>T.id!==a))},ge=a=>{if(a.preventDefault(),!C||!K){alert("Por favor completa el nombre de la tarea y quién la añadió.");return}if(m&&S==="weekly"&&le.length===0&&N!=="single"){alert("Por favor selecciona al menos un día para la tarea recurrente.");return}let T=parseInt(d,10);I==="PM"&&T!==12?T+=12:I==="AM"&&T===12&&(T=0);const X=`${String(T).padStart(2,"0")}:${A}`,h={text:C,employee:D,addedBy:K,duration:parseInt(_,10),shift:ee,zone:o,isCritical:i,notes:G,subtasks:p,...m&&{time:X,date:u,recurrence:S,selectedDays:le,recurrenceWeeks:g}};j(h,s==null?void 0:s.id)},ve=()=>{s&&R(s)},oe=!!s;return e.jsx(Te,{isOpen:t,onClose:k?()=>{}:b,title:s?"Editar Tarea":"Añadir Nueva Tarea",children:e.jsxs("form",{onSubmit:ge,className:"flex flex-col gap-4 max-h-[80vh] overflow-y-auto pr-2",children:[e.jsxs("fieldset",{disabled:k,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Nombre de la Tarea"}),e.jsx("input",{type:"text",value:C,onChange:a=>L(a.target.value),required:!0,className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Asignada a"}),e.jsx("select",{value:D,onChange:a=>B(a.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50",children:P.map(a=>e.jsx("option",{value:a.name,children:a.name},a.id))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Añadida por"}),e.jsx("select",{value:K,onChange:a=>U(a.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50",children:P.map(a=>e.jsx("option",{value:a.name,children:a.name},a.id))})]})]}),e.jsx("div",{className:"form-group mt-4 p-3 bg-gray-100 rounded-lg",children:e.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Planificar fecha y hora"}),e.jsx("div",{className:`w-11 h-6 rounded-full p-1 transition-colors ${m?"bg-blue-600":"bg-gray-300"}`,children:e.jsx("div",{className:`w-4 h-4 bg-white rounded-full shadow-md transform transition-transform ${m?"translate-x-5":""}`})}),e.jsx("input",{type:"checkbox",checked:m,onChange:a=>{const T=a.target.checked;if(y(T),T&&!(s!=null&&s.date)){const X=new Date;X.setMinutes(X.getMinutes()-X.getTimezoneOffset()),f(X.toISOString().split("T")[0])}},className:"hidden"})]})}),m&&e.jsxs("div",{className:"mt-4 flex flex-col gap-4",children:[(N==="single"||N==="new")&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Fecha"}),e.jsx("input",{type:"date",value:u,onChange:a=>f(a.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50"})]}),e.jsxs("fieldset",{disabled:oe&&N!=="future",className:"",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600 mb-2 block",children:"Repetición"}),e.jsxs("div",{className:"flex gap-2 bg-gray-200 rounded-lg p-1",children:[e.jsx("button",{type:"button",onClick:()=>te("once"),className:`flex-1 p-2 rounded-md text-sm font-bold transition-colors ${S==="once"?"bg-white shadow-sm":""}`,children:"Una vez"}),e.jsx("button",{type:"button",onClick:()=>te("weekly"),className:`flex-1 p-2 rounded-md text-sm font-bold transition-colors ${S==="weekly"?"bg-white shadow-sm":""}`,children:"Semanalmente"})]}),oe&&N==="single"&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"La repetición no se puede cambiar al editar una sola instancia."}),oe&&N==="future"&&e.jsxs("div",{className:"mt-2 p-3 bg-yellow-50 border-l-4 border-yellow-400 text-yellow-800 text-sm rounded-r-lg flex items-start gap-3",children:[e.jsx(z,{name:"alert-triangle",size:20,className:"flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:"Atención"}),e.jsx("p",{children:"Cambiar la repetición reemplazará todas las futuras tareas de esta serie."})]})]})]}),S==="weekly"&&e.jsxs("div",{className:"flex flex-col gap-4 mt-4",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600 mb-2 block",children:"Días de la semana"}),e.jsx("div",{className:"flex justify-between gap-1",children:Pe.map(({label:a,value:T})=>e.jsx("button",{type:"button",onClick:()=>Q(T),className:`w-9 h-9 flex items-center justify-center font-bold rounded-full border-2 transition-colors ${le.includes(T)?"bg-blue-600 text-white border-blue-600":"bg-gray-100 border-gray-300"}`,children:a},T))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Repetir durante"}),e.jsxs("select",{value:g,onChange:a=>x(a.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50",children:[e.jsx("option",{value:"4",children:"4 semanas"}),e.jsx("option",{value:"8",children:"8 semanas"}),e.jsx("option",{value:"12",children:"12 semanas"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Hora"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("select",{value:d,onChange:a=>O(a.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50",children:Array.from({length:12},(a,T)=>T+1).map(a=>e.jsx("option",{value:String(a).padStart(2,"0"),children:String(a).padStart(2,"0")},a))}),e.jsx("select",{value:A,onChange:a=>Y(a.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50",children:Array.from({length:60},(a,T)=>T).map(a=>e.jsx("option",{value:String(a).padStart(2,"0"),children:String(a).padStart(2,"0")},a))}),e.jsxs("select",{value:I,onChange:a=>H(a.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50",children:[e.jsx("option",{children:"AM"}),e.jsx("option",{children:"PM"})]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Turno"}),e.jsxs("select",{value:ee,onChange:a=>Z(a.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50",children:[e.jsx("option",{value:"matutino",children:"Matutino"}),e.jsx("option",{value:"pre-apertura",children:"Pre Apertura"}),e.jsx("option",{value:"cierre",children:"Cierre"}),e.jsx("option",{value:"default",children:"Otro"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Duración Estimada"}),e.jsx("select",{value:_,onChange:a=>F(a.target.value),required:!0,className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50",children:Ce.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Zona (Opcional)"}),e.jsx("input",{type:"text",value:o,onChange:a=>c(a.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50"})]})]}),e.jsxs("div",{className:"form-group mt-4",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Notas (Opcional)"}),e.jsx("textarea",{value:G,onChange:a=>J(a.target.value),rows:3,placeholder:"Añade comentarios o detalles adicionales aquí...",className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50"})]}),e.jsxs("div",{className:"form-group mt-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600 mb-2 block",children:"Subtareas"}),e.jsxs("div",{className:"bg-gray-100 p-3 rounded-lg",children:[p.length>0&&e.jsx("ul",{className:"space-y-2 mb-3",children:p.map(a=>e.jsxs("li",{className:"flex items-center justify-between bg-white p-2 rounded",children:[e.jsx("span",{className:"text-sm text-gray-700",children:a.text}),e.jsx("button",{type:"button",onClick:()=>ye(a.id),className:"p-1 text-gray-400 hover:text-red-600",children:e.jsx(z,{name:"trash-2",size:16})})]},a.id))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:l,onChange:a=>M(a.target.value),onKeyDown:he,placeholder:"Añadir una subtarea...",className:"w-full p-2 border border-gray-300 rounded-md bg-white text-sm"}),e.jsx("button",{type:"button",onClick:ae,className:"py-2 px-4 bg-blue-500 text-white font-semibold rounded-lg hover:bg-blue-600 text-sm",children:"Añadir"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("input",{type:"checkbox",id:"task-critical",checked:i,onChange:a=>w(a.target.checked),className:"w-4 h-4"}),e.jsx("label",{htmlFor:"task-critical",className:"text-sm font-medium text-gray-600",children:"Es una tarea crítica"})]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4 pt-4 border-t sticky bottom-0 bg-white",children:[e.jsx("div",{children:s&&e.jsx("button",{type:"button",onClick:ve,disabled:k,className:"py-2 px-4 bg-red-600 text-white font-semibold rounded-lg hover:bg-red-700 disabled:bg-red-400",children:"Eliminar"})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{type:"button",onClick:b,disabled:k,className:"py-2 px-4 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300 disabled:bg-gray-300",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:k,className:"py-2 px-4 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 w-36 flex items-center justify-center disabled:bg-blue-400",children:k?e.jsxs(e.Fragment,{children:[e.jsx(z,{name:"refresh-cw",className:"animate-spin mr-2",size:16}),"Guardando..."]}):"Guardar"})]})]})]})})},ke=({selectedDate:t,setSelectedDate:b,tasks:j,users:R,employeeFilter:s})=>{const[E,P]=r.useState(t),[N,k]=r.useState(""),W=r.useRef(0),C=r.useMemo(()=>R.reduce((o,c)=>(o[c.name]=c.color,o),{}),[R]),L=r.useMemo(()=>{const o=new Map;(s==="All"?j:j.filter(i=>i.employee===s)).forEach(i=>{if(i.date){const w=i.date;o.has(w)||o.set(w,[]),o.get(w).push(i.employee)}});for(const[i,w]of o.entries())o.set(i,Array.from(new Set(w)));return o},[j,s]);r.useEffect(()=>{P(t)},[t]),r.useEffect(()=>{if(N.startsWith("slide-out")){const o=N.includes("left")?"next":"prev",c=setTimeout(()=>{const i=new Date(E);i.setDate(i.getDate()+(o==="prev"?-7:7)),P(i);const w=new Date(t);w.setDate(w.getDate()+(o==="prev"?-7:7)),b(w),k(o==="next"?"slide-in-from-right":"slide-in-from-left")},200);return()=>clearTimeout(c)}else if(N.startsWith("slide-in")){const o=setTimeout(()=>{k("")},200);return()=>clearTimeout(o)}},[N,E,t,b]);const D=o=>{N||k(o==="next"?"slide-out-left":"slide-out-right")},B=o=>{const c=o.target.value;if(c){const i=new Date(c);i.setMinutes(i.getMinutes()+i.getTimezoneOffset()),b(i)}},d=o=>{W.current=o.targetTouches[0].clientX},O=o=>{const c=o.changedTouches[0].clientX,i=50,w=W.current-c;w>i?D("next"):w<-i&&D("prev")},A=new Date;A.setHours(0,0,0,0);const Y=new Date(E),I=E.getDay(),H=E.getDate()-I+(I===0?-6:1);Y.setDate(H),Y.setHours(0,0,0,0);const _=[];for(let o=0;o<7;o++){const c=new Date(Y);c.setDate(Y.getDate()+o),_.push(c)}const F=(o,c)=>o.getFullYear()===c.getFullYear()&&o.getMonth()===c.getMonth()&&o.getDate()===c.getDate(),ee=E.toLocaleDateString("es-ES",{month:"long",year:"numeric"}),Z=!F(t,A);return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2 px-2",children:[e.jsx("button",{onClick:()=>D("prev"),className:"p-2 text-gray-500 hover:text-blue-600 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(z,{name:"chevron-left",size:20})}),e.jsxs("div",{className:"flex items-center gap-2",children:[Z&&e.jsx("button",{onClick:()=>b(new Date),className:"text-xs font-bold text-blue-600 bg-blue-100 hover:bg-blue-200 px-3 py-1 rounded-full transition-colors",title:"Volver al día de hoy",children:"Hoy"}),e.jsx("h4",{className:"font-bold text-gray-700 capitalize text-sm",children:ee}),e.jsxs("div",{className:"relative w-9 h-9 flex items-center justify-center text-gray-500 hover:text-blue-600 rounded-full hover:bg-gray-100 transition-colors cursor-pointer",title:"Seleccionar fecha",children:[e.jsx(z,{name:"calendar",size:18}),e.jsx("input",{type:"date",onChange:B,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer","aria-label":"Seleccionar fecha"})]})]}),e.jsx("button",{onClick:()=>D("next"),className:"p-2 text-gray-500 hover:text-blue-600 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(z,{name:"chevron-right",size:20})})]}),e.jsx("div",{className:"p-1 bg-gray-200 rounded-lg overflow-hidden relative touch-pan-y",children:e.jsx("div",{className:`flex justify-between items-center gap-1 md:gap-2 ${N}`,onTouchStart:d,onTouchEnd:O,children:_.map(o=>{const c=F(o,t),i=F(o,A),w=new Date(o);w.setMinutes(w.getMinutes()-w.getTimezoneOffset());const G=w.toISOString().split("T")[0],J=L.get(G)||[];return e.jsx("button",{onClick:()=>b(o),className:"px-1 py-1 md:px-2 md:py-2 rounded-md transition-all duration-200 text-center flex-1",children:e.jsxs("div",{className:`${c?"bg-white shadow-sm rounded-md":""} py-1`,children:[e.jsx("span",{className:`text-xs uppercase font-bold ${c?"text-blue-600":"text-gray-500"}`,children:o.toLocaleDateString("es-ES",{weekday:"short"}).replace(".","")}),e.jsx("p",{className:`font-bold text-lg ${i?"text-blue-600":c?"text-gray-800":"text-gray-600"}`,children:o.getDate()}),e.jsx("div",{className:"flex justify-center items-center h-2 mt-1 gap-0.5",children:J.slice(0,4).map(S=>e.jsx("div",{className:"w-1.5 h-1.5 rounded-full",style:{backgroundColor:C[S]||"#9ca3af"},title:S},S))})]})},o.toISOString())})})})]})},Oe=t=>{switch(t){case"inprogress":return"opacity-100 animate-pulse-yellow";case"done":return"opacity-50";case"todo":default:return"opacity-100"}},Ae=Ee.forwardRef(({task:t,onUpdateStatus:b,onEdit:j,onViewSubtasks:R,style:s,userColor:E,onDragStart:P,onDragOver:N,onDrop:k,onDragEnd:W,onDragLeave:C,onTouchStart:L,onTouchMove:D,onTouchEnd:B,isBeingDragged:d,isDropTarget:O,isHighlighted:A},Y)=>{var G,J;const I=Oe(t.status),H=S=>{S.stopPropagation(),t.status==="todo"?b(t.id,"inprogress"):t.status==="inprogress"?b(t.id,"done"):t.status==="done"&&b(t.id,"todo")},_=new Date(`${t.date}T${t.time}`),ee=new Date(_.getTime()+t.duration*6e4).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit",hourCycle:"h23"}),Z=((G=t.subtasks)==null?void 0:G.length)||0,o=((J=t.subtasks)==null?void 0:J.filter(S=>S.isCompleted).length)||0,c={...s,borderWidth:"2px",borderColor:t.status==="inprogress"?E:"transparent",backgroundColor:"#f9fafb"},i={color:"#374151"},w=`
        absolute rounded-lg p-2 flex gap-2 transition-all duration-300 cursor-grab
        ${I}
        ${d?"opacity-40 scale-105":""}
        ${O?"drop-target-indicator":""}
        ${A?"animate-highlight":""}
    `;return e.jsxs("div",{ref:Y,style:c,draggable:!0,"data-task-id":t.id,onDragStart:()=>P(t.id),onDragOver:S=>N(S,t.id),onDrop:()=>k(t.id),onDragEnd:W,onDragLeave:C,onTouchStart:S=>L(S,t.id),onTouchMove:D,onTouchEnd:B,onClick:R,className:w,children:[e.jsx("div",{className:"flex-shrink-0 w-1 h-full rounded-full",style:{backgroundColor:E}}),e.jsxs("div",{className:"flex-grow flex flex-col min-w-0 min-h-0",children:[e.jsxs("div",{className:"flex-grow overflow-hidden",children:[e.jsxs("p",{className:`font-bold text-sm truncate ${t.status==="done"?"line-through":""}`,style:i,children:[t.isCritical&&e.jsx(z,{name:"alert-triangle",size:14,className:"inline-block mr-1 text-red-600",title:"Tarea Crítica"}),t.text]}),e.jsxs("p",{className:`text-xs ${t.status==="done"?"line-through":""}`,style:i,children:[t.time," - ",ee," (",t.duration," min)"]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-1 flex-shrink-0",children:[e.jsx("span",{className:"text-xs font-bold px-2 py-0.5 rounded-full bg-white/60",style:i,children:t.employee}),e.jsxs("div",{className:"flex items-center gap-2",style:i,children:[t.notes&&t.notes.trim()!==""&&e.jsx(z,{name:"message-square",size:14,title:"Esta tarea tiene notas"}),Z>0&&e.jsxs("div",{className:"flex items-center gap-1 text-xs font-semibold",children:[e.jsx(z,{name:"list",size:14}),e.jsxs("span",{children:[o,"/",Z]})]}),e.jsx("button",{onClick:S=>{S.stopPropagation(),j(t)},className:"p-1 rounded-full hover:bg-black/10 transition-colors",title:"Editar Tarea",children:e.jsx(z,{name:"pencil",size:14})})]})]})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("button",{onClick:H,className:"w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all",style:{borderColor:t.status==="done"?"#4ade80":"#9ca3af",backgroundColor:t.status==="done"?"#4ade80":"white"},children:[t.status==="inprogress"&&e.jsx("div",{className:"w-2.5 h-2.5 bg-yellow-500 rounded-full"}),t.status==="done"&&e.jsx(z,{name:"check",size:16,className:"text-white"})]})})]})}),ze=({task:t,onClose:b,onUpdateTask:j})=>{var D,B;const[R,s]=r.useState(""),E=d=>{const O=(t.subtasks||[]).map(A=>A.id===d?{...A,isCompleted:!A.isCompleted}:A);j({...t,subtasks:O})},P=()=>{if(R.trim()==="")return;const d={id:`sub-${Date.now()}`,text:R.trim(),isCompleted:!1},O=[...t.subtasks||[],d];j({...t,subtasks:O}),s("")},N=d=>{const O=(t.subtasks||[]).filter(A=>A.id!==d);j({...t,subtasks:O})},k=d=>{d.key==="Enter"&&(d.preventDefault(),P())},W=((D=t.subtasks)==null?void 0:D.filter(d=>d.isCompleted).length)||0,C=((B=t.subtasks)==null?void 0:B.length)||0,L=C>0?W/C*100:0;return e.jsx("div",{className:"fixed inset-0 bg-gray-900/60 z-[60] flex justify-center items-center p-4 backdrop-blur-sm",onClick:b,children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md flex flex-col animate-fadeIn",onClick:d=>d.stopPropagation(),children:[e.jsxs("header",{className:"p-4 border-b",children:[e.jsx("h3",{className:"font-bold text-lg text-blue-700",children:t.text}),e.jsxs("p",{className:"text-sm text-gray-500",children:[t.time," - ",t.employee]})]}),e.jsxs("div",{className:"p-4 flex-grow overflow-y-auto max-h-[60vh]",children:[t.notes&&t.notes.trim()!==""&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"font-bold text-gray-700 mb-2",children:"Notas"}),e.jsx("div",{className:"p-3 bg-yellow-50 border-l-4 border-yellow-400 text-gray-800 text-sm rounded-r-lg whitespace-pre-wrap",children:t.notes})]}),C>0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm mb-1",children:[e.jsx("span",{className:"font-semibold text-gray-600",children:"Progreso de Subtareas"}),e.jsxs("span",{children:[W," / ",C]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:e.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${L}%`}})})]}),e.jsx("div",{className:"space-y-2",children:(t.subtasks||[]).map(d=>e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-50 rounded-md group transition-colors hover:bg-gray-100",children:[e.jsx("input",{type:"checkbox",checked:d.isCompleted,onChange:()=>E(d.id),className:"w-5 h-5 rounded text-blue-600 focus:ring-blue-500 flex-shrink-0 cursor-pointer"}),e.jsx("span",{className:`flex-grow text-gray-800 ${d.isCompleted?"line-through text-gray-400":""}`,children:d.text}),e.jsx("button",{onClick:()=>N(d.id),className:"p-1 text-gray-400 hover:text-red-600 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(z,{name:"trash-2",size:16})})]},d.id))}),C===0&&(!t.notes||t.notes.trim()==="")&&e.jsx("p",{className:"text-center text-gray-500 py-6",children:"No hay subtareas ni notas. ¡Añade la primera!"})]}),e.jsx("div",{className:"p-4 border-t bg-gray-50 rounded-b-xl",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:R,onChange:d=>s(d.target.value),onKeyDown:k,placeholder:"Añadir nueva subtarea...",className:"w-full p-2 border border-gray-300 rounded-md bg-white text-sm focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{onClick:P,className:"py-2 px-4 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 text-sm",children:"Añadir"})]})})]})})},Ne=2.5,De=90,Me=15,Re=70,_e=100,He=40,Fe=t=>{const b=Math.floor(t/60),j=Math.round(t%60);return`${b}h ${j}min entre tareas`},We=t=>{const[b,j]=t.split(":").map(Number);return b*60+j},Le=({tasks:t,onUpdateStatus:b,onEditTask:j,onUpdateTask:R,onReorderTasks:s,users:E,highlightedTaskId:P,setHighlightedTaskId:N})=>{const[k,W]=r.useState(new Date),[C,L]=r.useState(null),[D,B]=r.useState(null),[d,O]=r.useState(null),A=r.useRef({}),Y=r.useMemo(()=>E.reduce((n,g)=>(n[g.name]=g.color,n),{}),[E]);r.useEffect(()=>{const n=setInterval(()=>W(new Date),6e4);return()=>clearInterval(n)},[]),r.useEffect(()=>{if(C){const n=t.find(g=>g.id===C.id);L(n||null)}},[t,C]),r.useEffect(()=>{if(P&&A.current[P]){const n=A.current[P];n==null||n.scrollIntoView({behavior:"smooth",block:"center"});const g=setTimeout(()=>{N(null)},2500);return()=>clearTimeout(g)}},[P,N]);const{timelineItems:I,totalHeight:H,getPositionForMinute:_}=r.useMemo(()=>{const n=[],g=t.filter(u=>u.time).sort((u,f)=>u.time.localeCompare(f.time));let x=je*60;g.forEach(u=>{const f=We(u.time),m=f+u.duration,y=f-x;y>De?n.push({type:"gap",startMinute:x,duration:y}):y>=Me?n.push({type:"short_break",startMinute:x,duration:y}):y>0&&n.push({type:"empty",startMinute:x,duration:y}),n.push({type:"task",task:u,startMinute:f,duration:u.duration}),x=Math.max(x,m)});const p=be*60-x;p>De?n.push({type:"gap",startMinute:x,duration:p}):p>=Me?n.push({type:"short_break",startMinute:x,duration:p}):p>0&&n.push({type:"empty",startMinute:x,duration:p});let v=0;const l=n.map(u=>{const f=v;let m=0;return u.type==="task"?m=Math.max(u.duration*Ne,_e):u.type==="gap"?m=Re:u.type==="short_break"?m=He:u.type==="empty"&&(m=u.duration*Ne),v+=m,{...u,top:f,height:m}});return{timelineItems:l,totalHeight:v,getPositionForMinute:u=>{for(const m of l)if(u>=m.startMinute&&u<m.startMinute+m.duration){const y=u-m.startMinute;if(m.type==="task"||m.type==="empty")return m.top+y*Ne;if(m.type==="gap"||m.type==="short_break")return m.top+y/m.duration*m.height}const f=l[l.length-1];return f?f.top+f.height:(u-je*60)*Ne}}},[t]),F=r.useMemo(()=>{const n=I.filter(v=>v.type==="task");if(n.length===0)return[];const g=[],x=new Set,p=[...n].sort((v,l)=>v.startMinute-l.startMinute);for(const v of p){if(x.has(v.task.id))continue;const l=[],M=[v],u=new Set([v.task.id]);for(;M.length>0;){const y=M.shift();l.push(y);const K=y.startMinute,U=K+y.task.duration;for(const Q of p)if(!u.has(Q.task.id)){const ae=Q.startMinute,he=ae+Q.task.duration;K<he&&U>ae&&(u.add(Q.task.id),M.push(Q))}}l.forEach(y=>x.add(y.task.id)),l.sort((y,K)=>y.startMinute-K.startMinute);const f=[];for(const y of l){let K=!1;for(const U of f){const Q=U[U.length-1],ae=Q.startMinute+Q.task.duration;if(y.startMinute>=ae){U.push(y),K=!0;break}}K||f.push([y])}const m=f.length;f.forEach((y,K)=>{y.forEach(U=>{g.push({task:U.task,top:U.top,height:U.height,width:100/m,left:K/m*100,zIndex:K+1})})})}return g},[I]),ee=r.useMemo(()=>{const n=new Map,g=new Map(F.map(l=>[l.task.id,l])),x=new Set;if(I.length===0)for(let l=je;l<=be;l++)x.add(l);else I.forEach(l=>{const M=Math.floor(l.startMinute/60),u=l.startMinute+l.duration,f=Math.ceil(u/60);l.type==="gap"?(x.add(M),x.add(f)):(l.type==="task"||(l.type==="empty"||l.type==="short_break")&&l.startMinute%60===0)&&x.add(M)}),x.add(je),x.add(be);x.forEach(l=>{l>be||n.set(l*60,`${String(l).padStart(2,"0")}:00`)}),I.forEach(l=>{if(l.type==="task"){const{startMinute:M,task:u}=l,f=g.get(u.id);if(f&&f.left>0)return;const m=Math.floor(M/60),y=M%60;y!==0&&n.set(M,`${String(m).padStart(2,"0")}:${String(y).padStart(2,"0")}`)}});const p=Array.from(n.entries()).map(([l,M])=>({minute:l,label:M})).sort((l,M)=>l.minute-M.minute);if(p.length<2)return p;const v=[p[0]];for(let l=1;l<p.length;l++){const M=v[v.length-1],u=p[l],f=_(M.minute);_(u.minute)-f>20&&v.push(u)}return v},[I,_,F]),Z=k.getHours()*60+k.getMinutes(),o=_(Z),c=n=>{B(n)},i=(n,g)=>{n.preventDefault(),g!==D&&O(g)},w=n=>{D&&n!==D&&s(D,n),B(null),O(null)},G=()=>{B(null),O(null)},J=()=>{O(null)},S=(n,g)=>{B(g)},te=n=>{if(!D)return;n.preventDefault();const g=n.touches[0],x=document.elementFromPoint(g.clientX,g.clientY);if(x){const p=x.closest("[data-task-id]");if(p){const v=p.getAttribute("data-task-id");v&&v!==D&&v!==d&&O(v)}else d&&O(null)}},le=()=>{D&&d&&s(D,d),B(null),O(null)};return e.jsxs("div",{className:"p-4 md:p-6 h-full relative",children:[e.jsxs("div",{className:"relative z-10",style:{height:`${H}px`},children:[ee.map(({minute:n,label:g})=>{const x=_(n);if(x>H+1||n>be*60)return null;const p=n%60===0;return e.jsxs("div",{className:"absolute w-full",style:{top:`${x}px`},children:[e.jsx("span",{className:`absolute -top-2.5 left-0 text-xs w-16 text-right pr-4 ${p?"font-semibold text-gray-500":"font-normal text-gray-400"}`,children:g}),e.jsx("div",{className:`h-px ml-16 ${p?"bg-gray-200":"bg-gray-200/60"}`})]},n)}),o>=0&&o<=H&&e.jsx("div",{className:"absolute left-16 right-0 h-0.5 bg-red-500 z-20",style:{top:`${o}px`},children:e.jsx("div",{className:"absolute -left-1.5 -top-1 w-3 h-3 bg-red-500 rounded-full border-2 border-white"})}),e.jsxs("div",{className:"absolute top-0 bottom-0 left-16 right-0",children:[I.filter(n=>n.type==="gap").map(n=>e.jsx("div",{className:"absolute w-full flex items-center",style:{top:`${n.top}px`,height:`${n.height}px`},children:e.jsx("div",{className:"w-full border-t-2 border-dashed border-gray-300 relative",children:e.jsx("span",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-gray-50 px-2 text-xs font-semibold text-gray-500",children:Fe(n.duration)})})},`gap-${n.startMinute}`)),I.filter(n=>n.type==="short_break").map(n=>e.jsx("div",{className:"absolute w-full flex items-center",style:{top:`${n.top}px`,height:`${n.height}px`},children:e.jsxs("div",{className:"w-full flex items-center justify-center gap-2 text-gray-400",children:[e.jsx("div",{className:"flex-grow border-t border-dashed border-gray-300"}),e.jsxs("span",{className:"text-xs font-semibold whitespace-nowrap",children:[Math.round(n.duration)," min libres"]}),e.jsx("div",{className:"flex-grow border-t border-dashed border-gray-300"})]})},`break-${n.startMinute}`)),F.map(({task:n,top:g,height:x,left:p,width:v,zIndex:l})=>e.jsx(Ae,{ref:M=>{A.current[n.id]=M},task:n,onUpdateStatus:b,onEdit:j,onViewSubtasks:()=>L(n),userColor:Y[n.employee]||"#9ca3af",style:{top:`${g}px`,height:`${x-4}px`,left:`${p}%`,width:`calc(${v}% - 4px)`,zIndex:l},onDragStart:c,onDragOver:i,onDrop:w,onDragEnd:G,onDragLeave:J,onTouchStart:S,onTouchMove:te,onTouchEnd:le,isBeingDragged:n.id===D,isDropTarget:n.id===d,isHighlighted:n.id===P},n.id))]})]}),C&&e.jsx(ze,{task:C,onClose:()=>L(null),onUpdateTask:R})]})},Be=t=>t>0?`en ${t} min`:t===0?"¡Ahora!":`hace ${Math.abs(t)} min`,Ge=({tasksWithDiff:t})=>e.jsxs("div",{className:"bg-yellow-100 border-b-2 border-yellow-300 p-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(z,{name:"alert-triangle",className:"text-yellow-600",size:20}),e.jsx("h3",{className:"font-bold text-yellow-800 text-base",children:"Tareas Críticas Próximas"})]}),e.jsx("div",{className:"flex gap-4 overflow-x-auto pb-2",children:t.map(({task:b,diff:j})=>e.jsxs("div",{className:"bg-white/70 p-2 rounded-lg border border-yellow-300 flex-shrink-0 w-60",children:[e.jsx("p",{className:"font-bold text-sm text-gray-800 truncate",children:b.text}),e.jsxs("p",{className:`text-xs font-semibold ${j<=0?"text-red-600 animate-pulse":"text-blue-600"}`,children:[b.time," (",Be(j),")"]})]},b.id))})]}),Ke=({isOpen:t,onClose:b,onSelectThisOne:j,onSelectFuture:R,isDelete:s=!1})=>{const P=`¿Qué tareas quieres ${s?"eliminar":"editar"}?`,N=s?"Eliminar solo esta tarea":"Editar solo esta tarea",k="La acción solo se aplicará a esta instancia. El resto de la serie no se verá afectado.",W=s?"Eliminar esta y futuras tareas":"Editar esta y futuras tareas",C="La acción se aplicará a esta y a todas las repeticiones futuras de la serie.",L=s?"trash-2":"pencil";return e.jsx(Te,{isOpen:t,onClose:b,title:P,children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("button",{onClick:j,className:"p-4 bg-gray-100 rounded-lg border-2 border-transparent hover:border-blue-500 transition-all text-left",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(z,{name:L,size:24,className:"text-blue-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-800",children:N}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:k})]})]})}),e.jsx("button",{onClick:R,className:"p-4 bg-gray-100 rounded-lg border-2 border-transparent hover:border-blue-500 transition-all text-left",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(z,{name:"calendar",size:24,className:"text-blue-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-800",children:W}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:C})]})]})}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx("button",{type:"button",onClick:b,className:"py-2 px-4 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300",children:"Cancelar"})})]})})},qe=({tasks:t,onEditTask:b,users:j})=>{const R=r.useMemo(()=>j.reduce((s,E)=>(s[E.name]=E.color,s),{}),[j]);return t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center text-gray-500 p-8",children:[e.jsx(z,{name:"check-circle",size:48,className:"text-green-500 mb-4"}),e.jsx("h3",{className:"text-xl font-bold",children:"¡Bandeja Limpia!"}),e.jsx("p",{children:"No hay tareas pendientes sin planificar."})]}):e.jsx("div",{className:"p-4 md:p-6",children:e.jsx("div",{className:"space-y-3",children:t.map(s=>e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200 shadow-sm hover:border-blue-400 transition-all flex flex-col gap-3",children:[e.jsxs("p",{className:"font-bold text-gray-800 break-words flex items-center gap-2",children:[s.isCritical&&e.jsx(z,{name:"alert-triangle",size:16,className:"text-red-500 flex-shrink-0",title:"Tarea Crítica"}),s.text,s.notes&&e.jsx(z,{name:"message-square",size:14,className:"text-gray-400 flex-shrink-0",title:"Tiene notas"})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm border-t pt-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-gray-500",children:"Para:"}),e.jsx("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:R[s.employee]||"#9ca3af"}}),e.jsx("span",{className:"text-gray-700 font-medium",children:s.employee})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[e.jsx("span",{children:"De:"}),e.jsx("span",{className:"text-gray-700 font-medium",children:s.addedBy})]})]}),e.jsx("div",{className:"mt-1",children:e.jsxs("button",{onClick:()=>b(s),className:"w-full flex-shrink-0 flex items-center justify-center gap-2 bg-blue-100 text-blue-700 font-semibold py-2 px-3 rounded-lg hover:bg-blue-200 transition-colors text-sm",children:[e.jsx(z,{name:"calendar",size:14}),"Planificar o Editar"]})})]},s.id))})})},Ve=({kanbanHook:t,criticalTasks:b,users:j,selectedDate:R,setSelectedDate:s,highlightedTaskId:E,setHighlightedTaskId:P})=>{const{tasks:N,addTask:k,addMultipleTasks:W,updateTask:C,updateTaskStatus:L,deleteTask:D,updateFutureTasks:B,deleteFutureTasks:d,reorderDailyTasks:O,generateDailyRoutines:A}=t,[Y,I]=r.useState(!1),[H,_]=r.useState(null),[F,ee]=r.useState("All"),[Z,o]=r.useState("agenda"),[c,i]=r.useState(null),[w,G]=r.useState(null),[J,S]=r.useState("new"),[te,le]=r.useState(null),[n,g]=r.useState(!1),[x,p]=r.useState(""),[v,l]=r.useState(""),[M,u]=r.useState(!1),f=r.useMemo(()=>{const h=new Date(R);return h.setMinutes(h.getMinutes()-h.getTimezoneOffset()),h.toISOString().split("T")[0]},[R]);r.useEffect(()=>{A(f)},[f,A]);const m=h=>{h.recurrenceId?(G("edit"),i(h)):(S("single"),_(h),I(!0))},y=()=>{I(!1),_(null),S("new")},K=async(h,ue)=>{const{recurrence:ie,selectedDays:se,recurrenceWeeks:ce,...q}=h;u(!0);try{if(ue&&H)if(!q.date)await C({...q,id:ue,status:H.status});else if(J==="future")if(ie==="weekly"&&se&&se.length>0){await d(H);const $=new Date(H.date);$.setMinutes($.getMinutes()+$.getTimezoneOffset());const de=parseInt(ce||"4",10),ne=[],me=new Date($),pe=$.getDay(),we=$.getDate()-pe+(pe===0?-6:1);me.setDate(we);for(let xe=0;xe<de;xe++){const re=new Date(me);re.setDate(me.getDate()+xe*7),se.forEach(Se=>{const fe=parseInt(Se,10),V=new Date(re);fe===0?V.setDate(re.getDate()+6):V.setDate(re.getDate()+(fe-1)),V.getTime()>=$.getTime()&&(V.setMinutes(V.getMinutes()-V.getTimezoneOffset()),ne.push({...q,date:V.toISOString().split("T")[0]}))})}await W(ne)}else{const{date:$,time:de,...ne}=q;await B(H,ne)}else{const{recurrenceId:$,...de}=H,ne={...de,...q,id:ue};await C(ne)}else if(!q.date)await k(q);else{const $=new Date(q.date);if($.setMinutes($.getMinutes()+$.getTimezoneOffset()),ie==="weekly"&&se&&se.length>0){const de=parseInt(ce||"4",10),ne=[],me=new Date($),pe=$.getDay(),we=$.getDate()-pe+(pe===0?-6:1);me.setDate(we);for(let xe=0;xe<de;xe++){const re=new Date(me);re.setDate(me.getDate()+xe*7),se.forEach(Se=>{const fe=parseInt(Se,10),V=new Date(re);fe===0?V.setDate(re.getDate()+6):V.setDate(re.getDate()+(fe-1)),V.setMinutes(V.getMinutes()-V.getTimezoneOffset()),ne.push({...q,date:V.toISOString().split("T")[0]})})}await W(ne)}else await k(q)}y()}catch($){console.error("Error saving task:",$)}finally{u(!1)}},U=h=>{I(!1),_(null),h.recurrenceId?(G("delete"),i(h)):ge(()=>D(h.id))},Q=()=>{c&&(S("single"),_(c),I(!0),i(null),G(null))},ae=()=>{c&&(S("future"),_(c),I(!0),i(null),G(null))},he=()=>{c&&(ge(()=>D(c.id)),i(null),G(null))},ye=()=>{c&&(ge(()=>d(c)),i(null),G(null))},ge=h=>{le(()=>h),g(!0),p(""),l("")},ve=()=>{x===Ie?(te==null||te(),g(!1),le(null)):(l("PIN incorrecto. Inténtalo de nuevo."),p(""))},oe=r.useMemo(()=>N.filter(h=>F==="All"||h.employee===F),[N,F]),a=r.useMemo(()=>oe.filter(h=>h.date===f),[oe,f]),T=r.useMemo(()=>oe.filter(h=>!h.date),[oe]),X=({view:h,label:ue,mobileLabel:ie,icon:se,count:ce})=>e.jsxs("button",{onClick:()=>o(h),className:`flex items-center gap-2 py-2 px-3 md:px-4 text-sm font-bold border-b-4 transition-colors ${Z===h?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-800"}`,children:[e.jsx(z,{name:se,size:18}),e.jsx("span",{className:"hidden md:inline",children:ue}),e.jsx("span",{className:"md:hidden",children:ie}),ce>0&&e.jsx("span",{className:"ml-1 text-xs bg-gray-300 text-gray-700 font-bold rounded-full px-2",children:ce})]});return e.jsxs("div",{className:"flex flex-col h-full bg-gray-50",children:[b.length>0&&e.jsx(Ge,{tasksWithDiff:b}),e.jsxs("div",{className:"operations-header flex flex-col p-4 border-b border-gray-200 gap-4 flex-shrink-0",children:[e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsxs("div",{className:"flex",children:[e.jsx(X,{view:"agenda",label:"Agenda Diaria",mobileLabel:"Agenda",icon:"calendar",count:0}),e.jsx(X,{view:"pending",label:"Tareas Pendientes",mobileLabel:"Pendientes",icon:"clipboard-list",count:T.length})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("button",{onClick:()=>{S("new"),_(null),I(!0)},className:"flex items-center justify-center bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors text-sm w-10 h-10 md:w-auto md:h-auto md:py-2 md:px-3",children:[e.jsx(z,{name:"plus-circle",size:20}),e.jsx("span",{className:"hidden md:inline ml-2",children:"Añadir Tarea"})]})})]}),Z==="agenda"&&e.jsx(ke,{selectedDate:R,setSelectedDate:s,tasks:N,users:j,employeeFilter:F}),e.jsxs("div",{className:"flex items-center gap-2 bg-gray-200 rounded-lg p-1 w-full overflow-x-auto",children:[e.jsx("button",{onClick:()=>ee("All"),className:`px-3 py-1 text-sm font-bold rounded-md transition-colors whitespace-nowrap ${F==="All"?"bg-white shadow-sm":"bg-transparent text-gray-600"}`,children:"Todos"}),j.map(h=>e.jsx("button",{onClick:()=>ee(h.name),className:`px-3 py-1 text-sm font-bold rounded-md transition-colors whitespace-nowrap ${F===h.name?"bg-white shadow-sm":"bg-transparent text-gray-600"}`,children:h.name},h.id))]})]}),e.jsx("div",{className:"flex-grow overflow-auto relative",children:Z==="agenda"?e.jsx(Le,{tasks:a,onEditTask:m,onUpdateStatus:L,onUpdateTask:C,onReorderTasks:O,users:j,highlightedTaskId:E,setHighlightedTaskId:P}):e.jsx(qe,{tasks:T,onEditTask:m,users:j})}),e.jsx($e,{isOpen:Y,onClose:y,onSave:K,onDelete:U,task:H,selectedDate:f,users:j,editMode:J,isSaving:M,allTasks:N}),e.jsx(Ke,{isOpen:!!c,onClose:()=>i(null),onSelectThisOne:w==="edit"?Q:he,onSelectFuture:w==="edit"?ae:ye,isDelete:w==="delete"}),n&&e.jsx(Te,{isOpen:n,onClose:()=>g(!1),title:"Confirmar Acción",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h4",{className:"font-bold text-lg text-gray-800",children:"Acción Protegida"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2 mb-4",children:"Para continuar, introduce el PIN de operaciones."}),e.jsx("input",{type:"password",value:x,onChange:h=>{p(h.target.value),l("")},placeholder:"PIN de Seguridad",autoFocus:!0,className:"w-full p-2 border border-gray-300 rounded-md text-center"}),v&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:v}),e.jsxs("div",{className:"flex gap-4 mt-4",children:[e.jsx("button",{onClick:()=>g(!1),className:"flex-1 py-2 px-4 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300",children:"Cancelar"}),e.jsx("button",{onClick:ve,className:"flex-1 py-2 px-4 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700",children:"Confirmar"})]})]})})]})};export{Ve as default};
