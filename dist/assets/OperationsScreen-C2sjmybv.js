import{r as l,j as e,I as z,T as Me,R as Ce,a as be,b as je,O as Ee}from"./index-Dwg9PiyN.js";import{M as Se}from"./Modal-CPKfXrv4.js";const Ie=[{label:"L",value:"1"},{label:"M",value:"2"},{label:"M",value:"3"},{label:"J",value:"4"},{label:"V",value:"5"},{label:"S",value:"6"},{label:"D",value:"0"}],Pe=({isOpen:t,onClose:g,onSave:f,onDelete:_,task:s,selectedDate:I,users:P,editMode:v,isSaving:k,allTasks:F})=>{const[M,W]=l.useState(""),[D,L]=l.useState(""),[c,O]=l.useState("08"),[A,H]=l.useState("00"),[C,B]=l.useState("AM"),[R,q]=l.useState("30"),[Y,ee]=l.useState("pre-apertura"),[r,m]=l.useState(""),[h,b]=l.useState(!1),[Z,K]=l.useState(""),[E,ae]=l.useState("once"),[oe,n]=l.useState([]),[y,d]=l.useState("4"),[p,j]=l.useState([]),[o,S]=l.useState(""),[u,w]=l.useState(I),[x,N]=l.useState(!0),[G,U]=l.useState("");l.useEffect(()=>{if(t){const a=P.length>0?P[0].name:"";N(!!(s!=null&&s.date)||v==="new"),W((s==null?void 0:s.text)||""),L((s==null?void 0:s.employee)||a),U((s==null?void 0:s.addedBy)||a),w((s==null?void 0:s.date)||I);const T=(s==null?void 0:s.time)||"08:00",[i,re]=T.split(":").map(Number),xe=i>=12?"PM":"AM";let Q=i%12;if(Q===0&&(Q=12),O(String(Q).padStart(2,"0")),H(String(re).padStart(2,"0")),B(xe),q(String((s==null?void 0:s.duration)||"30")),ee((s==null?void 0:s.shift)||"pre-apertura"),m((s==null?void 0:s.zone)||""),b((s==null?void 0:s.isCritical)||!1),K((s==null?void 0:s.notes)||""),j((s==null?void 0:s.subtasks)||[]),S(""),s&&v==="future"&&s.recurrenceId){ae("weekly");const ce=F.filter($=>$.recurrenceId===s.recurrenceId),V=new Set;ce.forEach($=>{if($.date){const te=new Date($.date);te.setMinutes(te.getMinutes()+te.getTimezoneOffset());const se=te.getDay();V.add(String(se))}}),n(Array.from(V))}else ae("once"),n([]);d("4")}},[t,s,P,I,v,F]);const J=a=>{n(T=>T.includes(a)?T.filter(i=>i!==a):[...T,a])},ne=()=>{if(o.trim()==="")return;const a={id:`sub-${Date.now()}`,text:o.trim(),isCompleted:!1};j([...p,a]),S("")},ie=a=>{a.key==="Enter"&&(a.preventDefault(),ne())},ye=a=>{j(p.filter(T=>T.id!==a))},he=a=>{if(a.preventDefault(),!M||!G){alert("Por favor completa el nombre de la tarea y quién la añadió.");return}if(x&&E==="weekly"&&oe.length===0&&v!=="single"){alert("Por favor selecciona al menos un día para la tarea recurrente.");return}let T=parseInt(c,10);C==="PM"&&T!==12?T+=12:C==="AM"&&T===12&&(T=0);const i=`${String(T).padStart(2,"0")}:${A}`,re={text:M,employee:D,addedBy:G,duration:parseInt(R,10),shift:Y,zone:r,isCritical:h,notes:Z,subtasks:p,...x&&{time:i,date:u,recurrence:E,selectedDays:oe,recurrenceWeeks:y}};f(re,s==null?void 0:s.id)},me=()=>{s&&_(s)},ge=!!s;return e.jsx(Se,{isOpen:t,onClose:k?()=>{}:g,title:s?"Editar Tarea":"Añadir Nueva Tarea",children:e.jsxs("form",{onSubmit:he,className:"flex flex-col gap-4 max-h-[80vh] overflow-y-auto pr-2",children:[e.jsxs("fieldset",{disabled:k,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Nombre de la Tarea"}),e.jsx("input",{type:"text",value:M,onChange:a=>W(a.target.value),required:!0,className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Asignada a"}),e.jsx("select",{value:D,onChange:a=>L(a.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50",children:P.map(a=>e.jsx("option",{value:a.name,children:a.name},a.id))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Añadida por"}),e.jsx("select",{value:G,onChange:a=>U(a.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50",children:P.map(a=>e.jsx("option",{value:a.name,children:a.name},a.id))})]})]}),e.jsx("div",{className:"form-group mt-4 p-3 bg-gray-100 rounded-lg",children:e.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Planificar fecha y hora"}),e.jsx("div",{className:`w-11 h-6 rounded-full p-1 transition-colors ${x?"bg-blue-600":"bg-gray-300"}`,children:e.jsx("div",{className:`w-4 h-4 bg-white rounded-full shadow-md transform transition-transform ${x?"translate-x-5":""}`})}),e.jsx("input",{type:"checkbox",checked:x,onChange:a=>{const T=a.target.checked;if(N(T),T&&!(s!=null&&s.date)){const i=new Date;i.setMinutes(i.getMinutes()-i.getTimezoneOffset()),w(i.toISOString().split("T")[0])}},className:"hidden"})]})}),x&&e.jsxs("div",{className:"mt-4 flex flex-col gap-4",children:[(v==="single"||v==="new")&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Fecha"}),e.jsx("input",{type:"date",value:u,onChange:a=>w(a.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50"})]}),e.jsxs("fieldset",{disabled:ge&&v!=="future",className:"",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600 mb-2 block",children:"Repetición"}),e.jsxs("div",{className:"flex gap-2 bg-gray-200 rounded-lg p-1",children:[e.jsx("button",{type:"button",onClick:()=>ae("once"),className:`flex-1 p-2 rounded-md text-sm font-bold transition-colors ${E==="once"?"bg-white shadow-sm":""}`,children:"Una vez"}),e.jsx("button",{type:"button",onClick:()=>ae("weekly"),className:`flex-1 p-2 rounded-md text-sm font-bold transition-colors ${E==="weekly"?"bg-white shadow-sm":""}`,children:"Semanalmente"})]}),ge&&v==="single"&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"La repetición no se puede cambiar al editar una sola instancia."}),ge&&v==="future"&&e.jsxs("div",{className:"mt-2 p-3 bg-yellow-50 border-l-4 border-yellow-400 text-yellow-800 text-sm rounded-r-lg flex items-start gap-3",children:[e.jsx(z,{name:"alert-triangle",size:20,className:"flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:"Atención"}),e.jsx("p",{children:"Cambiar la repetición reemplazará todas las futuras tareas de esta serie."})]})]})]}),E==="weekly"&&e.jsxs("div",{className:"flex flex-col gap-4 mt-4",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600 mb-2 block",children:"Días de la semana"}),e.jsx("div",{className:"flex justify-between gap-1",children:Ie.map(({label:a,value:T})=>e.jsx("button",{type:"button",onClick:()=>J(T),className:`w-9 h-9 flex items-center justify-center font-bold rounded-full border-2 transition-colors ${oe.includes(T)?"bg-blue-600 text-white border-blue-600":"bg-gray-100 border-gray-300"}`,children:a},T))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Repetir durante"}),e.jsxs("select",{value:y,onChange:a=>d(a.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50",children:[e.jsx("option",{value:"4",children:"4 semanas"}),e.jsx("option",{value:"8",children:"8 semanas"}),e.jsx("option",{value:"12",children:"12 semanas"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Hora"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("select",{value:c,onChange:a=>O(a.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50",children:Array.from({length:12},(a,T)=>T+1).map(a=>e.jsx("option",{value:String(a).padStart(2,"0"),children:String(a).padStart(2,"0")},a))}),e.jsx("select",{value:A,onChange:a=>H(a.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50",children:Array.from({length:60},(a,T)=>T).map(a=>e.jsx("option",{value:String(a).padStart(2,"0"),children:String(a).padStart(2,"0")},a))}),e.jsxs("select",{value:C,onChange:a=>B(a.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50",children:[e.jsx("option",{children:"AM"}),e.jsx("option",{children:"PM"})]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Turno"}),e.jsxs("select",{value:Y,onChange:a=>ee(a.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50",children:[e.jsx("option",{value:"matutino",children:"Matutino"}),e.jsx("option",{value:"pre-apertura",children:"Pre Apertura"}),e.jsx("option",{value:"cierre",children:"Cierre"}),e.jsx("option",{value:"default",children:"Otro"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Duración Estimada"}),e.jsx("select",{value:R,onChange:a=>q(a.target.value),required:!0,className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50",children:Me.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Zona (Opcional)"}),e.jsx("input",{type:"text",value:r,onChange:a=>m(a.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50"})]})]}),e.jsxs("div",{className:"form-group mt-4",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Notas (Opcional)"}),e.jsx("textarea",{value:Z,onChange:a=>K(a.target.value),rows:3,placeholder:"Añade comentarios o detalles adicionales aquí...",className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50"})]}),e.jsxs("div",{className:"form-group mt-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600 mb-2 block",children:"Subtareas"}),e.jsxs("div",{className:"bg-gray-100 p-3 rounded-lg",children:[p.length>0&&e.jsx("ul",{className:"space-y-2 mb-3",children:p.map(a=>e.jsxs("li",{className:"flex items-center justify-between bg-white p-2 rounded",children:[e.jsx("span",{className:"text-sm text-gray-700",children:a.text}),e.jsx("button",{type:"button",onClick:()=>ye(a.id),className:"p-1 text-gray-400 hover:text-red-600",children:e.jsx(z,{name:"trash-2",size:16})})]},a.id))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:o,onChange:a=>S(a.target.value),onKeyDown:ie,placeholder:"Añadir una subtarea...",className:"w-full p-2 border border-gray-300 rounded-md bg-white text-sm"}),e.jsx("button",{type:"button",onClick:ne,className:"py-2 px-4 bg-blue-500 text-white font-semibold rounded-lg hover:bg-blue-600 text-sm",children:"Añadir"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("input",{type:"checkbox",id:"task-critical",checked:h,onChange:a=>b(a.target.checked),className:"w-4 h-4"}),e.jsx("label",{htmlFor:"task-critical",className:"text-sm font-medium text-gray-600",children:"Es una tarea crítica"})]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4 pt-4 border-t sticky bottom-0 bg-white",children:[e.jsx("div",{children:s&&e.jsx("button",{type:"button",onClick:me,disabled:k,className:"py-2 px-4 bg-red-600 text-white font-semibold rounded-lg hover:bg-red-700 disabled:bg-red-400",children:"Eliminar"})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{type:"button",onClick:g,disabled:k,className:"py-2 px-4 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300 disabled:bg-gray-300",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:k,className:"py-2 px-4 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 w-36 flex items-center justify-center disabled:bg-blue-400",children:k?e.jsxs(e.Fragment,{children:[e.jsx(z,{name:"refresh-cw",className:"animate-spin mr-2",size:16}),"Guardando..."]}):"Guardar"})]})]})]})})},$e=({selectedDate:t,setSelectedDate:g,tasks:f,users:_,employeeFilter:s})=>{const[I,P]=l.useState(t),[v,k]=l.useState(""),F=l.useRef(0),M=l.useMemo(()=>_.reduce((r,m)=>(r[m.name]=m.color,r),{}),[_]),W=l.useMemo(()=>{const r=new Map;(s==="All"?f:f.filter(h=>h.employee===s)).forEach(h=>{if(h.date){const b=h.date;r.has(b)||r.set(b,[]),r.get(b).push(h.employee)}});for(const[h,b]of r.entries())r.set(h,Array.from(new Set(b)));return r},[f,s]);l.useEffect(()=>{P(t)},[t]),l.useEffect(()=>{if(v.startsWith("slide-out")){const r=v.includes("left")?"next":"prev",m=setTimeout(()=>{const h=new Date(I);h.setDate(h.getDate()+(r==="prev"?-7:7)),P(h);const b=new Date(t);b.setDate(b.getDate()+(r==="prev"?-7:7)),g(b),k(r==="next"?"slide-in-from-right":"slide-in-from-left")},200);return()=>clearTimeout(m)}else if(v.startsWith("slide-in")){const r=setTimeout(()=>{k("")},200);return()=>clearTimeout(r)}},[v,I,t,g]);const D=r=>{v||k(r==="next"?"slide-out-left":"slide-out-right")},L=r=>{const m=r.target.value;if(m){const h=new Date(m);h.setMinutes(h.getMinutes()+h.getTimezoneOffset()),g(h)}},c=r=>{F.current=r.targetTouches[0].clientX},O=r=>{const m=r.changedTouches[0].clientX,h=50,b=F.current-m;b>h?D("next"):b<-h&&D("prev")},A=new Date;A.setHours(0,0,0,0);const H=new Date(I),C=I.getDay(),B=I.getDate()-C+(C===0?-6:1);H.setDate(B),H.setHours(0,0,0,0);const R=[];for(let r=0;r<7;r++){const m=new Date(H);m.setDate(H.getDate()+r),R.push(m)}const q=(r,m)=>r.getFullYear()===m.getFullYear()&&r.getMonth()===m.getMonth()&&r.getDate()===m.getDate(),Y=I.toLocaleDateString("es-ES",{month:"long",year:"numeric"}),ee=!q(t,A);return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2 px-2",children:[e.jsx("button",{onClick:()=>D("prev"),className:"p-2 text-gray-500 hover:text-blue-600 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(z,{name:"chevron-left",size:20})}),e.jsxs("div",{className:"flex items-center gap-2",children:[ee&&e.jsx("button",{onClick:()=>g(new Date),className:"text-xs font-bold text-blue-600 bg-blue-100 hover:bg-blue-200 px-3 py-1 rounded-full transition-colors",title:"Volver al día de hoy",children:"Hoy"}),e.jsx("h4",{className:"font-bold text-gray-700 capitalize text-sm",children:Y}),e.jsxs("div",{className:"relative w-9 h-9 flex items-center justify-center text-gray-500 hover:text-blue-600 rounded-full hover:bg-gray-100 transition-colors cursor-pointer",title:"Seleccionar fecha",children:[e.jsx(z,{name:"calendar",size:18}),e.jsx("input",{type:"date",onChange:L,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer","aria-label":"Seleccionar fecha"})]})]}),e.jsx("button",{onClick:()=>D("next"),className:"p-2 text-gray-500 hover:text-blue-600 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(z,{name:"chevron-right",size:20})})]}),e.jsx("div",{className:"p-1 bg-gray-200 rounded-lg overflow-hidden relative touch-pan-y",children:e.jsx("div",{className:`flex justify-between items-center gap-1 md:gap-2 ${v}`,onTouchStart:c,onTouchEnd:O,children:R.map(r=>{const m=q(r,t),h=q(r,A),b=new Date(r);b.setMinutes(b.getMinutes()-b.getTimezoneOffset());const Z=b.toISOString().split("T")[0],K=W.get(Z)||[];return e.jsx("button",{onClick:()=>g(r),className:"px-1 py-1 md:px-2 md:py-2 rounded-md transition-all duration-200 text-center flex-1",children:e.jsxs("div",{className:`${m?"bg-white shadow-sm rounded-md":""} py-1`,children:[e.jsx("span",{className:`text-xs uppercase font-bold ${m?"text-blue-600":"text-gray-500"}`,children:r.toLocaleDateString("es-ES",{weekday:"short"}).replace(".","")}),e.jsx("p",{className:`font-bold text-lg ${h?"text-blue-600":m?"text-gray-800":"text-gray-600"}`,children:r.getDate()}),e.jsx("div",{className:"flex justify-center items-center h-2 mt-1 gap-0.5",children:K.slice(0,4).map(E=>e.jsx("div",{className:"w-1.5 h-1.5 rounded-full",style:{backgroundColor:M[E]||"#9ca3af"},title:E},E))})]})},r.toISOString())})})})]})},ke=t=>{switch(t){case"inprogress":return"opacity-100 animate-pulse-yellow";case"done":return"opacity-50";case"todo":default:return"opacity-100"}},Oe=Ce.forwardRef(({task:t,onUpdateStatus:g,onEdit:f,onViewSubtasks:_,style:s,userColor:I,onDragStart:P,onDragOver:v,onDrop:k,onDragEnd:F,onDragLeave:M,onTouchStart:W,onTouchMove:D,onTouchEnd:L,isBeingDragged:c,isDropTarget:O,isHighlighted:A},H)=>{var Z,K;const C=ke(t.status),B=E=>{E.stopPropagation(),t.status==="todo"?g(t.id,"inprogress"):t.status==="inprogress"?g(t.id,"done"):t.status==="done"&&g(t.id,"todo")},R=new Date(`${t.date}T${t.time}`),Y=new Date(R.getTime()+t.duration*6e4).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit",hourCycle:"h23"}),ee=((Z=t.subtasks)==null?void 0:Z.length)||0,r=((K=t.subtasks)==null?void 0:K.filter(E=>E.isCompleted).length)||0,m={...s,borderWidth:"2px",borderColor:t.status==="inprogress"?I:"transparent",backgroundColor:"#f9fafb"},h={color:"#374151"},b=`
        absolute rounded-lg p-2 flex gap-2 transition-all duration-300 cursor-grab
        ${C}
        ${c?"opacity-40 scale-105":""}
        ${O?"drop-target-indicator":""}
        ${A?"animate-highlight":""}
    `;return e.jsxs("div",{ref:H,style:m,draggable:!0,"data-task-id":t.id,onDragStart:()=>P(t.id),onDragOver:E=>v(E,t.id),onDrop:()=>k(t.id),onDragEnd:F,onDragLeave:M,onTouchStart:E=>W(E,t.id),onTouchMove:D,onTouchEnd:L,onClick:_,className:b,children:[e.jsx("div",{className:"flex-shrink-0 w-1 h-full rounded-full",style:{backgroundColor:I}}),e.jsxs("div",{className:"flex-grow flex flex-col min-w-0 min-h-0",children:[e.jsxs("div",{className:"flex-grow overflow-hidden",children:[e.jsxs("p",{className:`font-bold text-sm truncate ${t.status==="done"?"line-through":""}`,style:h,children:[t.isCritical&&e.jsx(z,{name:"alert-triangle",size:14,className:"inline-block mr-1 text-red-600",title:"Tarea Crítica"}),t.text]}),e.jsxs("p",{className:`text-xs ${t.status==="done"?"line-through":""}`,style:h,children:[t.time," - ",Y," (",t.duration," min)"]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-1 flex-shrink-0",children:[e.jsx("span",{className:"text-xs font-bold px-2 py-0.5 rounded-full bg-white/60",style:h,children:t.employee}),e.jsxs("div",{className:"flex items-center gap-2",style:h,children:[t.notes&&t.notes.trim()!==""&&e.jsx(z,{name:"message-square",size:14,title:"Esta tarea tiene notas"}),ee>0&&e.jsxs("div",{className:"flex items-center gap-1 text-xs font-semibold",children:[e.jsx(z,{name:"list",size:14}),e.jsxs("span",{children:[r,"/",ee]})]}),e.jsx("button",{onClick:E=>{E.stopPropagation(),f(t)},className:"p-1 rounded-full hover:bg-black/10 transition-colors",title:"Editar Tarea",children:e.jsx(z,{name:"pencil",size:14})})]})]})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("button",{onClick:B,className:"w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all",style:{borderColor:t.status==="done"?"#4ade80":"#9ca3af",backgroundColor:t.status==="done"?"#4ade80":"white"},children:[t.status==="inprogress"&&e.jsx("div",{className:"w-2.5 h-2.5 bg-yellow-500 rounded-full"}),t.status==="done"&&e.jsx(z,{name:"check",size:16,className:"text-white"})]})})]})}),Ae=({task:t,onClose:g,onUpdateTask:f})=>{var D,L;const[_,s]=l.useState(""),I=c=>{const O=(t.subtasks||[]).map(A=>A.id===c?{...A,isCompleted:!A.isCompleted}:A);f({...t,subtasks:O})},P=()=>{if(_.trim()==="")return;const c={id:`sub-${Date.now()}`,text:_.trim(),isCompleted:!1},O=[...t.subtasks||[],c];f({...t,subtasks:O}),s("")},v=c=>{const O=(t.subtasks||[]).filter(A=>A.id!==c);f({...t,subtasks:O})},k=c=>{c.key==="Enter"&&(c.preventDefault(),P())},F=((D=t.subtasks)==null?void 0:D.filter(c=>c.isCompleted).length)||0,M=((L=t.subtasks)==null?void 0:L.length)||0,W=M>0?F/M*100:0;return e.jsx("div",{className:"fixed inset-0 bg-gray-900/60 z-[60] flex justify-center items-center p-4 backdrop-blur-sm",onClick:g,children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md flex flex-col animate-fadeIn",onClick:c=>c.stopPropagation(),children:[e.jsxs("header",{className:"p-4 border-b",children:[e.jsx("h3",{className:"font-bold text-lg text-blue-700",children:t.text}),e.jsxs("p",{className:"text-sm text-gray-500",children:[t.time," - ",t.employee]})]}),e.jsxs("div",{className:"p-4 flex-grow overflow-y-auto max-h-[60vh]",children:[t.notes&&t.notes.trim()!==""&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"font-bold text-gray-700 mb-2",children:"Notas"}),e.jsx("div",{className:"p-3 bg-yellow-50 border-l-4 border-yellow-400 text-gray-800 text-sm rounded-r-lg whitespace-pre-wrap",children:t.notes})]}),M>0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm mb-1",children:[e.jsx("span",{className:"font-semibold text-gray-600",children:"Progreso de Subtareas"}),e.jsxs("span",{children:[F," / ",M]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:e.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${W}%`}})})]}),e.jsx("div",{className:"space-y-2",children:(t.subtasks||[]).map(c=>e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-50 rounded-md group transition-colors hover:bg-gray-100",children:[e.jsx("input",{type:"checkbox",checked:c.isCompleted,onChange:()=>I(c.id),className:"w-5 h-5 rounded text-blue-600 focus:ring-blue-500 flex-shrink-0 cursor-pointer"}),e.jsx("span",{className:`flex-grow text-gray-800 ${c.isCompleted?"line-through text-gray-400":""}`,children:c.text}),e.jsx("button",{onClick:()=>v(c.id),className:"p-1 text-gray-400 hover:text-red-600 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(z,{name:"trash-2",size:16})})]},c.id))}),M===0&&(!t.notes||t.notes.trim()==="")&&e.jsx("p",{className:"text-center text-gray-500 py-6",children:"No hay subtareas ni notas. ¡Añade la primera!"})]}),e.jsx("div",{className:"p-4 border-t bg-gray-50 rounded-b-xl",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:_,onChange:c=>s(c.target.value),onKeyDown:k,placeholder:"Añadir nueva subtarea...",className:"w-full p-2 border border-gray-300 rounded-md bg-white text-sm focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{onClick:P,className:"py-2 px-4 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 text-sm",children:"Añadir"})]})})]})})},Ne=2.5,Te=90,De=15,ze=70,_e=100,Re=40,He=t=>{const g=Math.floor(t/60),f=Math.round(t%60);return`${g}h ${f}min entre tareas`},Fe=t=>{const[g,f]=t.split(":").map(Number);return g*60+f},We=({tasks:t,onUpdateStatus:g,onEditTask:f,onUpdateTask:_,onReorderTasks:s,users:I,highlightedTaskId:P,setHighlightedTaskId:v})=>{const[k,F]=l.useState(new Date),[M,W]=l.useState(null),[D,L]=l.useState(null),[c,O]=l.useState(null),A=l.useRef({}),H=l.useMemo(()=>I.reduce((n,y)=>(n[y.name]=y.color,n),{}),[I]);l.useEffect(()=>{const n=setInterval(()=>F(new Date),6e4);return()=>clearInterval(n)},[]),l.useEffect(()=>{if(M){const n=t.find(y=>y.id===M.id);W(n||null)}},[t,M]),l.useEffect(()=>{if(P&&A.current[P]){const n=A.current[P];n==null||n.scrollIntoView({behavior:"smooth",block:"center"});const y=setTimeout(()=>{v(null)},2500);return()=>clearTimeout(y)}},[P,v]);const{timelineItems:C,totalHeight:B,getPositionForMinute:R}=l.useMemo(()=>{const n=[],y=t.filter(u=>u.time).sort((u,w)=>u.time.localeCompare(w.time));let d=je*60;y.forEach(u=>{const w=Fe(u.time),x=w+u.duration,N=w-d;N>Te?n.push({type:"gap",startMinute:d,duration:N}):N>=De?n.push({type:"short_break",startMinute:d,duration:N}):N>0&&n.push({type:"empty",startMinute:d,duration:N}),n.push({type:"task",task:u,startMinute:w,duration:u.duration}),d=Math.max(d,x)});const p=be*60-d;p>Te?n.push({type:"gap",startMinute:d,duration:p}):p>=De?n.push({type:"short_break",startMinute:d,duration:p}):p>0&&n.push({type:"empty",startMinute:d,duration:p});let j=0;const o=n.map(u=>{const w=j;let x=0;return u.type==="task"?x=Math.max(u.duration*Ne,_e):u.type==="gap"?x=ze:u.type==="short_break"?x=Re:u.type==="empty"&&(x=u.duration*Ne),j+=x,{...u,top:w,height:x}});return{timelineItems:o,totalHeight:j,getPositionForMinute:u=>{for(const x of o)if(u>=x.startMinute&&u<x.startMinute+x.duration){const N=u-x.startMinute;if(x.type==="task"||x.type==="empty")return x.top+N*Ne;if(x.type==="gap"||x.type==="short_break")return x.top+N/x.duration*x.height}const w=o[o.length-1];return w?w.top+w.height:(u-je*60)*Ne}}},[t]),q=l.useMemo(()=>{const n=C.filter(j=>j.type==="task");if(n.length===0)return[];const y=[],d=new Set,p=[...n].sort((j,o)=>j.startMinute-o.startMinute);for(const j of p){if(d.has(j.task.id))continue;const o=[],S=[j],u=new Set([j.task.id]);for(;S.length>0;){const N=S.shift();o.push(N);const G=N.startMinute,U=G+N.task.duration;for(const J of p)if(!u.has(J.task.id)){const ne=J.startMinute,ie=ne+J.task.duration;G<ie&&U>ne&&(u.add(J.task.id),S.push(J))}}o.forEach(N=>d.add(N.task.id)),o.sort((N,G)=>N.startMinute-G.startMinute);const w=[];for(const N of o){let G=!1;for(const U of w){const J=U[U.length-1],ne=J.startMinute+J.task.duration;if(N.startMinute>=ne){U.push(N),G=!0;break}}G||w.push([N])}const x=w.length;w.forEach((N,G)=>{N.forEach(U=>{y.push({task:U.task,top:U.top,height:U.height,width:100/x,left:G/x*100,zIndex:G+1})})})}return y},[C]),Y=l.useMemo(()=>{const n=new Map,y=new Map(q.map(o=>[o.task.id,o])),d=new Set;if(C.length===0)for(let o=je;o<=be;o++)d.add(o);else C.forEach(o=>{const S=Math.floor(o.startMinute/60),u=o.startMinute+o.duration,w=Math.ceil(u/60);o.type==="gap"?(d.add(S),d.add(w)):(o.type==="task"||(o.type==="empty"||o.type==="short_break")&&o.startMinute%60===0)&&d.add(S)}),d.add(je),d.add(be);d.forEach(o=>{o>be||n.set(o*60,`${String(o).padStart(2,"0")}:00`)}),C.forEach(o=>{if(o.type==="task"){const{startMinute:S,task:u}=o,w=y.get(u.id);if(w&&w.left>0)return;const x=Math.floor(S/60),N=S%60;N!==0&&n.set(S,`${String(x).padStart(2,"0")}:${String(N).padStart(2,"0")}`)}});const p=Array.from(n.entries()).map(([o,S])=>({minute:o,label:S})).sort((o,S)=>o.minute-S.minute);if(p.length<2)return p;const j=[p[0]];for(let o=1;o<p.length;o++){const S=j[j.length-1],u=p[o],w=R(S.minute);R(u.minute)-w>20&&j.push(u)}return j},[C,R,q]),ee=k.getHours()*60+k.getMinutes(),r=R(ee),m=n=>{L(n)},h=(n,y)=>{n.preventDefault(),y!==D&&O(y)},b=n=>{D&&n!==D&&s(D,n),L(null),O(null)},Z=()=>{L(null),O(null)},K=()=>{O(null)},E=(n,y)=>{L(y)},ae=n=>{if(!D)return;n.preventDefault();const y=n.touches[0],d=document.elementFromPoint(y.clientX,y.clientY);if(d){const p=d.closest("[data-task-id]");if(p){const j=p.getAttribute("data-task-id");j&&j!==D&&j!==c&&O(j)}else c&&O(null)}},oe=()=>{D&&c&&s(D,c),L(null),O(null)};return e.jsxs("div",{className:"p-4 md:p-6 h-full relative",children:[e.jsxs("div",{className:"relative z-10",style:{height:`${B}px`},children:[Y.map(({minute:n,label:y})=>{const d=R(n);if(d>B+1||n>be*60)return null;const p=n%60===0;return e.jsxs("div",{className:"absolute w-full",style:{top:`${d}px`},children:[e.jsx("span",{className:`absolute -top-2.5 left-0 text-xs w-16 text-right pr-4 ${p?"font-semibold text-gray-500":"font-normal text-gray-400"}`,children:y}),e.jsx("div",{className:`h-px ml-16 ${p?"bg-gray-200":"bg-gray-200/60"}`})]},n)}),r>=0&&r<=B&&e.jsx("div",{className:"absolute left-16 right-0 h-0.5 bg-red-500 z-20",style:{top:`${r}px`},children:e.jsx("div",{className:"absolute -left-1.5 -top-1 w-3 h-3 bg-red-500 rounded-full border-2 border-white"})}),e.jsxs("div",{className:"absolute top-0 bottom-0 left-16 right-0",children:[C.filter(n=>n.type==="gap").map(n=>e.jsx("div",{className:"absolute w-full flex items-center",style:{top:`${n.top}px`,height:`${n.height}px`},children:e.jsx("div",{className:"w-full border-t-2 border-dashed border-gray-300 relative",children:e.jsx("span",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-gray-50 px-2 text-xs font-semibold text-gray-500",children:He(n.duration)})})},`gap-${n.startMinute}`)),C.filter(n=>n.type==="short_break").map(n=>e.jsx("div",{className:"absolute w-full flex items-center",style:{top:`${n.top}px`,height:`${n.height}px`},children:e.jsxs("div",{className:"w-full flex items-center justify-center gap-2 text-gray-400",children:[e.jsx("div",{className:"flex-grow border-t border-dashed border-gray-300"}),e.jsxs("span",{className:"text-xs font-semibold whitespace-nowrap",children:[Math.round(n.duration)," min libres"]}),e.jsx("div",{className:"flex-grow border-t border-dashed border-gray-300"})]})},`break-${n.startMinute}`)),q.map(({task:n,top:y,height:d,left:p,width:j,zIndex:o})=>e.jsx(Oe,{ref:S=>{A.current[n.id]=S},task:n,onUpdateStatus:g,onEdit:f,onViewSubtasks:()=>W(n),userColor:H[n.employee]||"#9ca3af",style:{top:`${y}px`,height:`${d-4}px`,left:`${p}%`,width:`calc(${j}% - 4px)`,zIndex:o},onDragStart:m,onDragOver:h,onDrop:b,onDragEnd:Z,onDragLeave:K,onTouchStart:E,onTouchMove:ae,onTouchEnd:oe,isBeingDragged:n.id===D,isDropTarget:n.id===c,isHighlighted:n.id===P},n.id))]})]}),M&&e.jsx(Ae,{task:M,onClose:()=>W(null),onUpdateTask:_})]})},Le=t=>t>0?`en ${t} min`:t===0?"¡Ahora!":`hace ${Math.abs(t)} min`,Be=({tasksWithDiff:t})=>e.jsxs("div",{className:"bg-yellow-100 border-b-2 border-yellow-300 p-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(z,{name:"alert-triangle",className:"text-yellow-600",size:20}),e.jsx("h3",{className:"font-bold text-yellow-800 text-base",children:"Tareas Críticas Próximas"})]}),e.jsx("div",{className:"flex gap-4 overflow-x-auto pb-2",children:t.map(({task:g,diff:f})=>e.jsxs("div",{className:"bg-white/70 p-2 rounded-lg border border-yellow-300 flex-shrink-0 w-60",children:[e.jsx("p",{className:"font-bold text-sm text-gray-800 truncate",children:g.text}),e.jsxs("p",{className:`text-xs font-semibold ${f<=0?"text-red-600 animate-pulse":"text-blue-600"}`,children:[g.time," (",Le(f),")"]})]},g.id))})]}),Ge=({isOpen:t,onClose:g,onSelectThisOne:f,onSelectFuture:_,isDelete:s=!1})=>{const P=`¿Qué tareas quieres ${s?"eliminar":"editar"}?`,v=s?"Eliminar solo esta tarea":"Editar solo esta tarea",k="La acción solo se aplicará a esta instancia. El resto de la serie no se verá afectado.",F=s?"Eliminar esta y futuras tareas":"Editar esta y futuras tareas",M="La acción se aplicará a esta y a todas las repeticiones futuras de la serie.",W=s?"trash-2":"pencil";return e.jsx(Se,{isOpen:t,onClose:g,title:P,children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("button",{onClick:f,className:"p-4 bg-gray-100 rounded-lg border-2 border-transparent hover:border-blue-500 transition-all text-left",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(z,{name:W,size:24,className:"text-blue-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-800",children:v}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:k})]})]})}),e.jsx("button",{onClick:_,className:"p-4 bg-gray-100 rounded-lg border-2 border-transparent hover:border-blue-500 transition-all text-left",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(z,{name:"calendar",size:24,className:"text-blue-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-800",children:F}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:M})]})]})}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx("button",{type:"button",onClick:g,className:"py-2 px-4 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300",children:"Cancelar"})})]})})},Ke=({tasks:t,onEditTask:g,users:f})=>{const _=l.useMemo(()=>f.reduce((s,I)=>(s[I.name]=I.color,s),{}),[f]);return t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center text-gray-500 p-8",children:[e.jsx(z,{name:"check-circle",size:48,className:"text-green-500 mb-4"}),e.jsx("h3",{className:"text-xl font-bold",children:"¡Bandeja Limpia!"}),e.jsx("p",{children:"No hay tareas pendientes sin planificar."})]}):e.jsx("div",{className:"p-4 md:p-6",children:e.jsx("div",{className:"space-y-3",children:t.map(s=>e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200 shadow-sm hover:border-blue-400 transition-all flex flex-col gap-3",children:[e.jsxs("p",{className:"font-bold text-gray-800 break-words flex items-center gap-2",children:[s.isCritical&&e.jsx(z,{name:"alert-triangle",size:16,className:"text-red-500 flex-shrink-0",title:"Tarea Crítica"}),s.text,s.notes&&e.jsx(z,{name:"message-square",size:14,className:"text-gray-400 flex-shrink-0",title:"Tiene notas"})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm border-t pt-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-gray-500",children:"Para:"}),e.jsx("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:_[s.employee]||"#9ca3af"}}),e.jsx("span",{className:"text-gray-700 font-medium",children:s.employee})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[e.jsx("span",{children:"De:"}),e.jsx("span",{className:"text-gray-700 font-medium",children:s.addedBy})]})]}),e.jsx("div",{className:"mt-1",children:e.jsxs("button",{onClick:()=>g(s),className:"w-full flex-shrink-0 flex items-center justify-center gap-2 bg-blue-100 text-blue-700 font-semibold py-2 px-3 rounded-lg hover:bg-blue-200 transition-colors text-sm",children:[e.jsx(z,{name:"calendar",size:14}),"Planificar o Editar"]})})]},s.id))})})},Xe=({kanbanHook:t,criticalTasks:g,users:f,selectedDate:_,setSelectedDate:s,highlightedTaskId:I,setHighlightedTaskId:P})=>{const{tasks:v,addTask:k,addMultipleTasks:F,updateTask:M,updateTaskStatus:W,deleteTask:D,updateFutureTasks:L,deleteFutureTasks:c,reorderDailyTasks:O}=t,[A,H]=l.useState(!1),[C,B]=l.useState(null),[R,q]=l.useState("All"),[Y,ee]=l.useState("agenda"),[r,m]=l.useState(null),[h,b]=l.useState(null),[Z,K]=l.useState("new"),[E,ae]=l.useState(null),[oe,n]=l.useState(!1),[y,d]=l.useState(""),[p,j]=l.useState(""),[o,S]=l.useState(!1),u=i=>{i.recurrenceId?(b("edit"),m(i)):(K("single"),B(i),H(!0))},w=()=>{H(!1),B(null),K("new")},x=async(i,re)=>{const{recurrence:xe,selectedDays:Q,recurrenceWeeks:ce,...V}=i;S(!0);try{if(re&&C)if(!V.date)await M({...V,id:re,status:C.status});else if(Z==="future")if(xe==="weekly"&&Q&&Q.length>0){await c(C);const $=new Date(C.date);$.setMinutes($.getMinutes()+$.getTimezoneOffset());const te=parseInt(ce||"4",10),se=[],de=new Date($),pe=$.getDay(),ve=$.getDate()-pe+(pe===0?-6:1);de.setDate(ve);for(let ue=0;ue<te;ue++){const le=new Date(de);le.setDate(de.getDate()+ue*7),Q.forEach(we=>{const fe=parseInt(we,10),X=new Date(le);fe===0?X.setDate(le.getDate()+6):X.setDate(le.getDate()+(fe-1)),X.getTime()>=$.getTime()&&(X.setMinutes(X.getMinutes()-X.getTimezoneOffset()),se.push({...V,date:X.toISOString().split("T")[0]}))})}await F(se)}else{const{date:$,time:te,...se}=V;await L(C,se)}else{const{recurrenceId:$,...te}=C,se={...te,...V,id:re};await M(se)}else if(!V.date)await k(V);else{const $=new Date(V.date);if($.setMinutes($.getMinutes()+$.getTimezoneOffset()),xe==="weekly"&&Q&&Q.length>0){const te=parseInt(ce||"4",10),se=[],de=new Date($),pe=$.getDay(),ve=$.getDate()-pe+(pe===0?-6:1);de.setDate(ve);for(let ue=0;ue<te;ue++){const le=new Date(de);le.setDate(de.getDate()+ue*7),Q.forEach(we=>{const fe=parseInt(we,10),X=new Date(le);fe===0?X.setDate(le.getDate()+6):X.setDate(le.getDate()+(fe-1)),X.setMinutes(X.getMinutes()-X.getTimezoneOffset()),se.push({...V,date:X.toISOString().split("T")[0]})})}await F(se)}else await k(V)}w()}catch($){console.error("Error saving task:",$)}finally{S(!1)}},N=i=>{H(!1),B(null),i.recurrenceId?(b("delete"),m(i)):ie(()=>D(i.id))},G=()=>{r&&(K("single"),B(r),H(!0),m(null),b(null))},U=()=>{r&&(K("future"),B(r),H(!0),m(null),b(null))},J=()=>{r&&(ie(()=>D(r.id)),m(null),b(null))},ne=()=>{r&&(ie(()=>c(r)),m(null),b(null))},ie=i=>{ae(()=>i),n(!0),d(""),j("")},ye=()=>{y===Ee?(E==null||E(),n(!1),ae(null)):(j("PIN incorrecto. Inténtalo de nuevo."),d(""))},he=l.useMemo(()=>{const i=new Date(_);return i.setMinutes(i.getMinutes()-i.getTimezoneOffset()),i.toISOString().split("T")[0]},[_]),me=l.useMemo(()=>v.filter(i=>R==="All"||i.employee===R),[v,R]),ge=l.useMemo(()=>me.filter(i=>i.date===he),[me,he]),a=l.useMemo(()=>me.filter(i=>!i.date),[me]),T=({view:i,label:re,mobileLabel:xe,icon:Q,count:ce})=>e.jsxs("button",{onClick:()=>ee(i),className:`flex items-center gap-2 py-2 px-3 md:px-4 text-sm font-bold border-b-4 transition-colors ${Y===i?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-800"}`,children:[e.jsx(z,{name:Q,size:18}),e.jsx("span",{className:"hidden md:inline",children:re}),e.jsx("span",{className:"md:hidden",children:xe}),ce>0&&e.jsx("span",{className:"ml-1 text-xs bg-gray-300 text-gray-700 font-bold rounded-full px-2",children:ce})]});return e.jsxs("div",{className:"flex flex-col h-full bg-gray-50",children:[g.length>0&&e.jsx(Be,{tasksWithDiff:g}),e.jsxs("div",{className:"operations-header flex flex-col p-4 border-b border-gray-200 gap-4 flex-shrink-0",children:[e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsxs("div",{className:"flex",children:[e.jsx(T,{view:"agenda",label:"Agenda Diaria",mobileLabel:"Agenda",icon:"calendar",count:0}),e.jsx(T,{view:"pending",label:"Tareas Pendientes",mobileLabel:"Pendientes",icon:"clipboard-list",count:a.length})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("button",{onClick:()=>{K("new"),B(null),H(!0)},className:"flex items-center justify-center bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors text-sm w-10 h-10 md:w-auto md:h-auto md:py-2 md:px-3",children:[e.jsx(z,{name:"plus-circle",size:20}),e.jsx("span",{className:"hidden md:inline ml-2",children:"Añadir Tarea"})]})})]}),Y==="agenda"&&e.jsx($e,{selectedDate:_,setSelectedDate:s,tasks:v,users:f,employeeFilter:R}),e.jsxs("div",{className:"flex items-center gap-2 bg-gray-200 rounded-lg p-1 w-full overflow-x-auto",children:[e.jsx("button",{onClick:()=>q("All"),className:`px-3 py-1 text-sm font-bold rounded-md transition-colors whitespace-nowrap ${R==="All"?"bg-white shadow-sm":"bg-transparent text-gray-600"}`,children:"Todos"}),f.map(i=>e.jsx("button",{onClick:()=>q(i.name),className:`px-3 py-1 text-sm font-bold rounded-md transition-colors whitespace-nowrap ${R===i.name?"bg-white shadow-sm":"bg-transparent text-gray-600"}`,children:i.name},i.id))]})]}),e.jsx("div",{className:"flex-grow overflow-auto relative",children:Y==="agenda"?e.jsx(We,{tasks:ge,onEditTask:u,onUpdateStatus:W,onUpdateTask:M,onReorderTasks:O,users:f,highlightedTaskId:I,setHighlightedTaskId:P}):e.jsx(Ke,{tasks:a,onEditTask:u,users:f})}),e.jsx(Pe,{isOpen:A,onClose:w,onSave:x,onDelete:N,task:C,selectedDate:he,users:f,editMode:Z,isSaving:o,allTasks:v}),e.jsx(Ge,{isOpen:!!r,onClose:()=>m(null),onSelectThisOne:h==="edit"?G:J,onSelectFuture:h==="edit"?U:ne,isDelete:h==="delete"}),oe&&e.jsx(Se,{isOpen:oe,onClose:()=>n(!1),title:"Confirmar Acción",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h4",{className:"font-bold text-lg text-gray-800",children:"Acción Protegida"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2 mb-4",children:"Para continuar, introduce el PIN de operaciones."}),e.jsx("input",{type:"password",value:y,onChange:i=>{d(i.target.value),j("")},placeholder:"PIN de Seguridad",autoFocus:!0,className:"w-full p-2 border border-gray-300 rounded-md text-center"}),p&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:p}),e.jsxs("div",{className:"flex gap-4 mt-4",children:[e.jsx("button",{onClick:()=>n(!1),className:"flex-1 py-2 px-4 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300",children:"Cancelar"}),e.jsx("button",{onClick:ye,className:"flex-1 py-2 px-4 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700",children:"Confirmar"})]})]})})]})};export{Xe as default};
