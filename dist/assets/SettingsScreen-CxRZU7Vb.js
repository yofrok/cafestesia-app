import{r as n,j as e,I as C,R as Ne,q as we,o as Ce,d as Se,e as ke,f as Y,g as te,h as Re,u as Ee,i as De,T as Ae,k as Me}from"./index-BcEhsMjZ.js";import{M as U}from"./Modal-pn_fuNFk.js";const Te=({isOpen:c,onClose:o,onSave:m,onDelete:h,provider:t})=>{const[s,r]=n.useState("");n.useEffect(()=>{c&&r((t==null?void 0:t.name)||"")},[c,t]);const i=b=>{if(b.preventDefault(),!s.trim())return;const j={name:s.trim()};m(t?{...j,id:t.id}:j),o()},x=()=>{t&&window.confirm(`Â¿EstÃ¡s seguro de que quieres eliminar al proveedor "${t.name}"?`)&&(h(t.id),o())};return e.jsx(U,{isOpen:c,onClose:o,title:t?"Editar Proveedor":"AÃ±adir Proveedor",children:e.jsxs("form",{onSubmit:i,className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Nombre del Proveedor"}),e.jsx("input",{type:"text",value:s,onChange:b=>r(b.target.value),required:!0,autoFocus:!0,className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsx("div",{children:t&&e.jsx("button",{type:"button",onClick:x,className:"py-2 px-4 bg-red-600 text-white font-semibold rounded-lg hover:bg-red-700",children:"Eliminar"})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{type:"button",onClick:o,className:"py-2 px-4 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"py-2 px-4 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700",children:"Guardar"})]})]})]})})},Pe=({isOpen:c,onClose:o,onSave:m,onDelete:h,category:t})=>{const[s,r]=n.useState("");n.useEffect(()=>{c&&r((t==null?void 0:t.name)||"")},[c,t]);const i=b=>{if(b.preventDefault(),!s.trim())return;const j={name:s.trim()};m(t?{...j,id:t.id}:j),o()},x=()=>{t&&window.confirm(`Â¿EstÃ¡s seguro de que quieres eliminar la categorÃ­a "${t.name}"?`)&&(h(t.id),o())};return e.jsx(U,{isOpen:c,onClose:o,title:t?"Editar CategorÃ­a":"AÃ±adir CategorÃ­a",children:e.jsxs("form",{onSubmit:i,className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Nombre de la CategorÃ­a"}),e.jsx("input",{type:"text",value:s,onChange:b=>r(b.target.value),required:!0,autoFocus:!0,className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsx("div",{children:t&&e.jsx("button",{type:"button",onClick:x,className:"py-2 px-4 bg-red-600 text-white font-semibold rounded-lg hover:bg-red-700",children:"Eliminar"})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{type:"button",onClick:o,className:"py-2 px-4 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"py-2 px-4 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700",children:"Guardar"})]})]})]})})},Oe=({rating:c})=>e.jsx("div",{className:"flex",children:[...Array(5)].map((o,m)=>e.jsx(C,{name:"star",size:16,className:m<c?"text-yellow-400 fill-current":"text-gray-300"},m))}),ze=({isOpen:c,onClose:o,recipe:m,feedbackLog:h})=>{const t=[...h].sort((s,r)=>new Date(r.date).getTime()-new Date(s.date).getTime());return e.jsxs(U,{isOpen:c,onClose:o,title:`BitÃ¡cora de: ${m.name}`,children:[e.jsx("div",{className:"max-h-[60vh] overflow-y-auto pr-2",children:t.length>0?e.jsx("div",{className:"space-y-4",children:t.map(s=>e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:new Date(s.date).toLocaleString("es-ES",{dateStyle:"long",timeStyle:"short"})}),e.jsx(Oe,{rating:s.rating})]}),e.jsx("p",{className:"text-gray-600 whitespace-pre-wrap",children:s.notes||"Sin notas."})]},s.id))}):e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No hay feedback registrado para esta receta todavÃ­a."})}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx("button",{onClick:o,className:"py-2 px-6 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300",children:"Cerrar"})})]})},qe=({isOpen:c,onClose:o,onSave:m,onDelete:h,user:t})=>{const[s,r]=n.useState(""),[i,x]=n.useState("#CCCCCC"),[b,j]=n.useState("");n.useEffect(()=>{c&&(r((t==null?void 0:t.name)||""),x((t==null?void 0:t.color)||"#CCCCCC"),j((t==null?void 0:t.phone)||""))},[c,t]);const S=d=>{if(d.preventDefault(),!s.trim())return;const u={name:s.trim(),color:i,phone:b.trim()};m(t?{...u,id:t.id}:u),o()},g=()=>{t&&window.confirm(`Â¿EstÃ¡s seguro de que quieres eliminar a "${t.name}"? Esto no se puede deshacer.`)&&(h(t.id),o())};return e.jsx(U,{isOpen:c,onClose:o,title:t?"Editar Usuario":"AÃ±adir Usuario",children:e.jsxs("form",{onSubmit:S,className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Nombre del Usuario"}),e.jsx("input",{type:"text",value:s,onChange:d=>r(d.target.value),required:!0,autoFocus:!0,className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"NÃºmero de WhatsApp (Opcional)"}),e.jsx("input",{type:"tel",value:b,onChange:d=>j(d.target.value),placeholder:"+521234567890",className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Color de Etiqueta"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"color",value:i,onChange:d=>x(d.target.value),className:"w-12 h-10 p-1 border border-gray-300 rounded-md cursor-pointer"}),e.jsx("input",{type:"text",value:i,onChange:d=>x(d.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50 font-mono focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsx("div",{children:t&&e.jsx("button",{type:"button",onClick:g,className:"py-2 px-4 bg-red-600 text-white font-semibold rounded-lg hover:bg-red-700",children:"Eliminar"})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{type:"button",onClick:o,className:"py-2 px-4 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"py-2 px-4 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700",children:"Guardar"})]})]})]})})},Ie=({steps:c,setSteps:o})=>{const m=(s,r,i)=>{const x=[...c];r==="duration"?x[s][r]=typeof i=="string"?parseInt(i,10)*60:i:x[s][r]=i,o(x)},h=()=>{o([...c,{duration:300,instruction:"Nuevo paso",type:"active"}])},t=s=>{c.length<=1||o(c.filter((r,i)=>i!==s))};return e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-blue-700 mb-2",children:"Pasos del Proceso"}),e.jsxs("div",{className:"space-y-3 bg-gray-100 p-3 rounded-lg border",children:[c.map((s,r)=>e.jsx("div",{className:"flex flex-col gap-2 bg-white p-3 rounded-md shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("span",{className:"font-bold text-gray-500 mt-2",children:[r+1,"."]}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("textarea",{value:s.instruction,onChange:i=>m(r,"instruction",i.target.value),rows:2,placeholder:"InstrucciÃ³n del paso",className:"w-full p-2 text-sm border border-gray-300 rounded-md mb-2"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center flex-grow",children:[e.jsx("span",{className:"text-xs font-bold text-gray-500 mr-2 uppercase",children:"DuraciÃ³n:"}),e.jsx("input",{type:"number",value:s.duration/60,onChange:i=>m(r,"duration",i.target.value),min:"1",className:"w-16 p-1 text-sm border border-gray-300 rounded-md text-center"}),e.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"min"})]}),e.jsxs("div",{className:"flex items-center bg-gray-100 rounded-lg p-1",children:[e.jsx("button",{type:"button",onClick:()=>m(r,"type","active"),className:`px-3 py-1 text-xs font-bold rounded-md transition-colors ${s.type==="active"||!s.type?"bg-white text-blue-600 shadow-sm":"text-gray-500"}`,children:"Manual"}),e.jsx("button",{type:"button",onClick:()=>m(r,"type","passive"),className:`px-3 py-1 text-xs font-bold rounded-md transition-colors ${s.type==="passive"?"bg-white text-teal-600 shadow-sm":"text-gray-500"}`,children:"Espera"})]})]})]}),e.jsx("button",{type:"button",onClick:()=>t(r),disabled:c.length<=1,className:"p-2 text-red-500 hover:bg-red-100 rounded-full disabled:text-gray-400 disabled:cursor-not-allowed mt-2",children:e.jsx(C,{name:"trash-2",size:18})})]})},r)),e.jsxs("button",{type:"button",onClick:h,className:"w-full mt-2 py-2 px-4 bg-blue-100 text-blue-700 font-semibold rounded-lg hover:bg-blue-200 transition-colors text-sm flex items-center justify-center gap-2",children:[e.jsx(C,{name:"plus",size:16}),"AÃ±adir Paso"]})]})]})},Ue=({variants:c,setVariants:o,baseSteps:m})=>{const[h,t]=n.useState(""),[s,r]=n.useState(""),[i,x]=n.useState(null),b=()=>{if(!h.trim())return;const d={id:`var-${Date.now()}`,name:h.trim(),description:s.trim(),stepOverrides:Array(m.length).fill(null)};o([...c,d]),t(""),r("")},j=d=>{o(c.filter(u=>u.id!==d)),(i==null?void 0:i.id)===d&&x(null)},S=(d,u,p)=>{o(N=>N.map(f=>f.id===d?{...f,[u]:p}:f))},g=(d,u,p)=>{o(N=>N.map(f=>{if(f.id===d){const w=[...f.stepOverrides],D=p.trim()===m[u].instruction.trim()?null:p.trim();return D===null?w[u]=null:w[u]={...w[u]||{},instruction:D},w[u]&&Object.keys(w[u]).length===0&&(w[u]=null),{...f,stepOverrides:w}}return f}))};return e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-blue-700 mb-2",children:"Variantes de Receta (Opcional)"}),e.jsxs("div",{className:"space-y-3 bg-gray-100 p-3 rounded-lg border",children:[c.map(d=>{const u=(i==null?void 0:i.id)===d.id;return e.jsxs("div",{className:"bg-white p-3 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[u?e.jsx("input",{type:"text",value:d.name,onChange:p=>S(d.id,"name",p.target.value),className:"font-semibold text-gray-800 p-1 border border-gray-300 rounded-md w-full mr-2"}):e.jsx("h4",{className:"font-semibold text-gray-800",children:d.name}),e.jsxs("div",{children:[e.jsx("button",{type:"button",onClick:()=>x(u?null:d),className:`p-2 rounded-full transition-colors ${u?"bg-blue-100 text-blue-600":"text-gray-500 hover:bg-gray-100"}`,children:e.jsx(C,{name:"pencil",size:16})}),e.jsx("button",{type:"button",onClick:()=>j(d.id),className:"p-2 text-red-500 hover:bg-red-100 rounded-full",children:e.jsx(C,{name:"trash-2",size:16})})]})]}),u&&e.jsxs("div",{className:"space-y-2 mt-2 pt-2 border-t",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"DescripciÃ³n de la Variante"}),e.jsx("input",{type:"text",value:d.description||"",onChange:p=>S(d.id,"description",p.target.value),placeholder:"Ej: 1 charola (6-8 pzas)",className:"w-full p-1 border border-gray-300 rounded-md"})]}),m.map((p,N)=>{const f=d.stepOverrides[N];return e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsxs("span",{className:"font-bold text-gray-500 mt-2",children:[N+1,"."]}),e.jsxs("div",{className:"flex-grow",children:[e.jsxs("label",{className:"text-xs text-gray-500",children:['InstrucciÃ³n (Base: "',p.instruction,'")']}),e.jsx("textarea",{value:(f==null?void 0:f.instruction)||p.instruction,onChange:w=>g(d.id,N,w.target.value),rows:2,className:"w-full p-1 border border-gray-300 rounded-md"})]})]},N)})]})]},d.id)}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-2 pt-2",children:[e.jsx("input",{type:"text",value:h,onChange:d=>t(d.target.value),placeholder:"Nombre de variante (ej: Media Charola)",className:"w-full p-2 border border-gray-300 rounded-md bg-white text-sm"}),e.jsx("input",{type:"text",value:s,onChange:d=>r(d.target.value),placeholder:"DescripciÃ³n (ej: 1 charola)",className:"w-full p-2 border border-gray-300 rounded-md bg-white text-sm"}),e.jsx("button",{type:"button",onClick:b,className:"flex-shrink-0 py-2 px-4 bg-blue-500 text-white font-semibold rounded-lg hover:bg-blue-600 text-sm",children:"AÃ±adir"})]})]})]})},Ve=({isOpen:c,onClose:o,onSave:m,onDelete:h,recipe:t})=>{const[s,r]=n.useState(""),[i,x]=n.useState(""),[b,j]=n.useState(""),[S,g]=n.useState(""),[d,u]=n.useState(""),[p,N]=n.useState([]),[f,w]=n.useState([]);n.useEffect(()=>{c&&(r((t==null?void 0:t.name)||""),x((t==null?void 0:t.pluralName)||""),j((t==null?void 0:t.setupInstruction)||""),g((t==null?void 0:t.baseVariantName)||"Receta EstÃ¡ndar"),u((t==null?void 0:t.baseVariantDescription)||""),N((t==null?void 0:t.steps)||[{duration:300,instruction:"Nuevo paso",type:"active"}]),w((t==null?void 0:t.variants)||[]))},[c,t]);const D=v=>{v.preventDefault();const R=p.reduce((T,P)=>T+P.duration,0);m({name:s,pluralName:i,setupInstruction:b,baseVariantName:S,baseVariantDescription:d,steps:p,variants:f,totalDuration:R}),o()},V=()=>{t&&window.confirm(`âš ï¸ Â¿EstÃ¡s seguro de eliminar la receta "${t.name}"?

Esta acciÃ³n no se puede deshacer y perderÃ¡s el historial asociado.`)&&(h(t.id),o())};return e.jsx(U,{isOpen:c,onClose:o,title:t?`Editar Receta: ${t.name}`:"AÃ±adir Nueva Receta",children:e.jsxs("form",{onSubmit:D,className:"flex flex-col gap-6 max-h-[80vh] overflow-y-auto pr-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(F,{label:"Nombre de la Receta (Singular)",children:e.jsx("input",{type:"text",value:s,onChange:v=>r(v.target.value),required:!0})}),e.jsx(F,{label:"Nombre para Notificaciones (Plural)",children:e.jsx("input",{type:"text",value:i,onChange:v=>x(v.target.value),placeholder:"Ej: Roles de Canela listos",required:!0})})]}),e.jsx(F,{label:"InstrucciÃ³n de ConfiguraciÃ³n Inicial",children:e.jsx("textarea",{value:b,onChange:v=>j(v.target.value),rows:2})}),e.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h3",{className:"text-md font-bold text-blue-800 mb-2",children:"ConfiguraciÃ³n de la Receta Base"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(F,{label:"Nombre de la Variante Base",children:e.jsx("input",{type:"text",value:S,onChange:v=>g(v.target.value),required:!0})}),e.jsx(F,{label:"DescripciÃ³n de la Variante Base",children:e.jsx("input",{type:"text",value:d,onChange:v=>u(v.target.value),placeholder:"Ej: 2 charolas (12 pzas)"})})]})]}),e.jsx(Ie,{steps:p,setSteps:N}),e.jsx(Ue,{variants:f,setVariants:w,baseSteps:p}),e.jsxs("div",{className:"flex justify-between items-center mt-4 pt-4 border-t sticky bottom-0 bg-white",children:[e.jsx("div",{children:t&&e.jsx("button",{type:"button",onClick:V,className:"py-2 px-4 bg-red-600 text-white font-semibold rounded-lg hover:bg-red-700",children:"Eliminar"})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{type:"button",onClick:o,className:"py-2 px-4 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"py-2 px-4 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700",children:"Guardar Receta"})]})]})]})})},F=({label:c,children:o})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:c}),Ne.cloneElement(o,{className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),ae=Se(Y,"task_templates"),Le=()=>{const[c,o]=n.useState([]);return n.useEffect(()=>{const s=we(ae,Ce("title")),r=ke(s,i=>{const x=i.docs.map(b=>({id:b.id,...b.data()}));o(x)},i=>{console.error("Error fetching routines:",i)});return()=>r()},[]),{routines:c,addRoutine:async s=>{try{await De(ae,s)}catch(r){console.error("Error adding routine:",r)}},updateRoutine:async s=>{const{id:r,...i}=s,x=te(Y,"task_templates",r);try{await Ee(x,i)}catch(b){console.error("Error updating routine:",b)}},deleteRoutine:async s=>{const r=te(Y,"task_templates",s);try{await Re(r)}catch(i){console.error("Error deleting routine:",i)}}}},Be=[{label:"Lunes",value:1},{label:"Martes",value:2},{label:"MiÃ©rcoles",value:3},{label:"Jueves",value:4},{label:"Viernes",value:5},{label:"SÃ¡bado",value:6},{label:"Domingo",value:0}],$e=({isOpen:c,onClose:o,onSave:m,onUpdate:h,onDelete:t,routine:s,users:r})=>{var $;const[i,x]=n.useState(""),[b,j]=n.useState("08:00"),[S,g]=n.useState("30"),[d,u]=n.useState("pre-apertura"),[p,N]=n.useState(""),[f,w]=n.useState(!1),[D,V]=n.useState(""),[v,R]=n.useState([]),[T,P]=n.useState(""),[L,A]=n.useState([]),[M,z]=n.useState((($=r[0])==null?void 0:$.name)||""),[q,I]=n.useState({});n.useEffect(()=>{var l;c&&(x((s==null?void 0:s.title)||""),j((s==null?void 0:s.time)||"08:00"),g(String((s==null?void 0:s.duration)||"30")),u((s==null?void 0:s.shift)||"pre-apertura"),N((s==null?void 0:s.zone)||""),w((s==null?void 0:s.isCritical)||!1),V((s==null?void 0:s.notes)||""),R((s==null?void 0:s.subtasks)||[]),A((s==null?void 0:s.frequencyDays)||[]),z((s==null?void 0:s.defaultEmployee)||((l=r[0])==null?void 0:l.name)||""),I((s==null?void 0:s.customAssignments)||{}))},[c,s,r]);const H=l=>{if(l.preventDefault(),!i.trim())return;const y={title:i,subtasks:v,notes:D,frequencyDays:L,time:b,duration:parseInt(S),shift:d,zone:p,isCritical:f,defaultEmployee:M,customAssignments:q};s?h({...y,id:s.id}):m(y),o()},J=l=>{if(L.includes(l)){A(k=>k.filter(O=>O!==l));const y={...q};delete y[l],I(y)}else A(y=>[...y,l])},B=(l,y)=>{if(y===M){const k={...q};delete k[l],I(k)}else I(k=>({...k,[l]:y}))},K=()=>{T.trim()&&(R([...v,{id:`st-${Date.now()}`,text:T,isCompleted:!1}]),P(""))};return e.jsx(U,{isOpen:c,onClose:o,title:s?"Editar Rutina":"Nueva Rutina Maestra",children:e.jsxs("form",{onSubmit:H,className:"flex flex-col gap-5 max-h-[80vh] overflow-y-auto pr-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"Nombre de la Tarea"}),e.jsx("input",{type:"text",value:i,onChange:l=>x(l.target.value),required:!0,className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50",placeholder:"Ej: Limpieza de MÃ¡quina"})]}),e.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h4",{className:"font-bold text-gray-700",children:"ProgramaciÃ³n y AsignaciÃ³n"}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Por defecto:",e.jsx("select",{value:M,onChange:l=>z(l.target.value),className:"ml-2 p-1 rounded border border-gray-300 font-bold text-blue-600",children:r.map(l=>e.jsx("option",{value:l.name,children:l.name},l.id))})]})]}),e.jsx("div",{className:"space-y-2",children:Be.map(l=>{var G;const y=L.includes(l.value),k=q[l.value]||M,O=((G=r.find(E=>E.name===k))==null?void 0:G.color)||"#ccc";return e.jsxs("div",{className:`flex items-center justify-between p-2 rounded-md transition-colors ${y?"bg-white shadow-sm border border-blue-200":"opacity-60"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:y,onChange:()=>J(l.value),className:"w-5 h-5 text-blue-600 rounded focus:ring-blue-500 cursor-pointer"}),e.jsx("span",{className:`font-medium ${y?"text-gray-900":"text-gray-500"}`,children:l.label})]}),y&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"Asignar a:"}),e.jsx("div",{className:"relative",children:e.jsx("select",{value:k,onChange:E=>B(l.value,E.target.value),className:"pl-2 pr-6 py-1 text-sm border border-gray-300 rounded-md bg-gray-50 appearance-none cursor-pointer hover:border-blue-400 focus:outline-none",style:{borderLeftWidth:"4px",borderLeftColor:O},children:r.map(E=>e.jsx("option",{value:E.name,children:E.name},E.id))})})]})]},l.value)})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"Hora (24h)"}),e.jsx("input",{type:"time",value:b,onChange:l=>j(l.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"DuraciÃ³n"}),e.jsx("select",{value:S,onChange:l=>g(l.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50",children:Ae.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"Turno"}),e.jsxs("select",{value:d,onChange:l=>u(l.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50",children:[e.jsx("option",{value:"pre-apertura",children:"Pre-apertura"}),e.jsx("option",{value:"matutino",children:"Matutino"}),e.jsx("option",{value:"cierre",children:"Cierre"}),e.jsx("option",{value:"default",children:"Otro"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"Zona"}),e.jsx("input",{type:"text",value:p,onChange:l=>N(l.target.value),className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"Subtareas Maestras"}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-200",children:[e.jsx("ul",{className:"mb-2 space-y-1",children:v.map((l,y)=>e.jsxs("li",{className:"flex justify-between text-sm bg-white p-1 px-2 rounded border border-gray-100",children:[e.jsx("span",{children:l.text}),e.jsx("button",{type:"button",onClick:()=>R(v.filter((k,O)=>O!==y)),className:"text-red-400 hover:text-red-600",children:e.jsx(C,{name:"x",size:14})})]},y))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:T,onChange:l=>P(l.target.value),placeholder:"Nueva subtarea...",className:"flex-1 p-1 text-sm border rounded"}),e.jsx("button",{type:"button",onClick:K,className:"px-3 bg-blue-500 text-white rounded text-sm",children:e.jsx(C,{name:"plus",size:14})})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:f,onChange:l=>w(l.target.checked),className:"w-4 h-4 text-red-600"}),e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Marcar como CrÃ­tica"})]}),e.jsxs("div",{className:"flex justify-between pt-4 border-t",children:[s&&e.jsx("button",{type:"button",onClick:()=>{window.confirm("Borrar rutina?")&&t(s.id),o()},className:"px-4 py-2 text-red-600 bg-red-50 rounded-lg hover:bg-red-100",children:"Eliminar"}),e.jsxs("div",{className:"flex gap-2 ml-auto",children:[e.jsx("button",{type:"button",onClick:o,className:"px-4 py-2 text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"px-4 py-2 text-white bg-blue-600 rounded-lg hover:bg-blue-700 font-bold",children:"Guardar Rutina"})]})]})]})})},Fe=({users:c})=>{const{routines:o,addRoutine:m,updateRoutine:h,deleteRoutine:t}=Le(),[s,r]=n.useState(!1),[i,x]=n.useState(null),b=()=>{x(null),r(!0)},j=g=>{x(g),r(!0)},S=g=>{if(g.length===7)return"Todos los dÃ­as";if(g.length===0)return"Sin programar";const d=["D","L","M","M","J","V","S"];return g.sort().map(u=>d[u]).join(", ")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Rutinas Maestras"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Configura tareas recurrentes y sus asignaciones automÃ¡ticas."})]}),e.jsxs("button",{onClick:b,className:"flex items-center gap-2 bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors text-sm",children:[e.jsx(C,{name:"plus-circle",size:16}),"Nueva Rutina"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.map(g=>e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-all cursor-pointer group",onClick:()=>j(g),children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"font-bold text-gray-800 group-hover:text-blue-600 transition-colors",children:g.title}),e.jsx(C,{name:"pencil",size:16,className:"text-gray-300 group-hover:text-blue-500"})]}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{name:"calendar",size:14,className:"text-gray-400"}),e.jsx("span",{children:S(g.frequencyDays)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{name:"check-circle",size:14,className:"text-gray-400"}),e.jsxs("span",{children:[g.time," (",g.shift,")"]})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100 flex items-center gap-2 text-xs",children:[e.jsx("span",{className:"text-gray-400",children:"AsignaciÃ³n:"}),e.jsx("span",{className:"bg-gray-100 px-2 py-1 rounded text-gray-700 font-medium",children:g.defaultEmployee}),Object.keys(g.customAssignments).length>0&&e.jsxs("span",{className:"bg-blue-50 text-blue-600 px-2 py-1 rounded font-bold",children:["+",Object.keys(g.customAssignments).length," Excepciones"]})]})]},g.id)),o.length===0&&e.jsx("div",{className:"col-span-full text-center py-10 text-gray-400 bg-gray-50 rounded-xl border border-dashed border-gray-300",children:e.jsx("p",{children:"No hay rutinas configuradas."})})]}),e.jsx($e,{isOpen:s,onClose:()=>r(!1),onSave:m,onUpdate:h,onDelete:t,routine:i,users:c})]})},He=({providersHook:c,categoriesHook:o,recipeLogHook:m,usersHook:h,recipesHook:t})=>{const[s,r]=n.useState("production"),[i,x]=n.useState(!1),{providers:b,addProvider:j,updateProvider:S,deleteProvider:g}=c,[d,u]=n.useState(!1),[p,N]=n.useState(null),{categories:f,addCategory:w,updateCategory:D,deleteCategory:V}=o,[v,R]=n.useState(!1),[T,P]=n.useState(null),{feedbackLog:L}=m,[A,M]=n.useState(null),{users:z,addUser:q,updateUser:I,deleteUser:H}=h,[J,B]=n.useState(!1),[K,$]=n.useState(null),{recipes:l,addRecipe:y,updateRecipe:k,deleteRecipe:O,resetRecipesToFactory:G}=t,[E,W]=n.useState(!1),[Z,Q]=n.useState(null),{clearAllTasks:re,resetTasksToDefault:le}=Me(),ne=a=>{N(a),u(!0)},oe=()=>{N(null),u(!0)},ie=a=>{"id"in a?S(a):j(a)},de=a=>{P(a),R(!0)},ce=()=>{P(null),R(!0)},me=a=>{"id"in a?D(a):w(a)},ue=a=>{$(a),B(!0)},xe=()=>{$(null),B(!0)},be=a=>{"id"in a?I(a):q(a)},X=a=>{Q(a),W(!0)},ge=()=>{Q(null),W(!0)},he=a=>{Z?k({...a,id:Z.id}):y(a)},pe=async()=>{if(window.confirm(`ðŸš‘ Â¿Reiniciar CronÃ³metros?

Esto detendrÃ¡ todos los procesos de panaderÃ­a activos y limpiarÃ¡ la memoria local del navegador.

âœ… TUS TAREAS, RECETAS E INVENTARIO NO SE BORRARÃN.`)){x(!0);try{localStorage.removeItem("productionState_v2"),alert("CronÃ³metros reiniciados. La aplicaciÃ³n se recargarÃ¡."),window.location.reload()}catch(a){console.error("Error repairing app:",a),alert("Error al reparar. Intenta recargar la pÃ¡gina manualmente."),x(!1)}}},fe=async()=>{window.confirm(`âš ï¸ Â¿Borrar TODAS las tareas?

Esto dejarÃ¡ la agenda y el tablero completamente vacÃ­os. Esta acciÃ³n no se puede deshacer.`)&&(await re(),alert("Todas las tareas han sido eliminadas."))},je=async()=>{window.confirm(`âš ï¸ Â¿Restaurar Tareas por Defecto?

Esto borrarÃ¡ todas tus tareas actuales y volverÃ¡ a cargar las tareas de ejemplo.`)&&(await le(),alert("Tareas restauradas a los valores por defecto."))},_=({tab:a,label:ye,icon:ve})=>e.jsxs("button",{onClick:()=>r(a),className:`flex items-center gap-2 py-3 px-4 text-sm md:text-base font-bold border-b-4 transition-colors ${s===a?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-800"}`,children:[e.jsx(C,{name:ve,size:18}),ye]}),ee=l.filter(a=>a.name.toLowerCase().includes("(horneado)")),se=l.filter(a=>!a.name.toLowerCase().includes("(horneado)"));return e.jsxs("div",{className:"p-4 md:p-6 bg-gray-50 h-full overflow-y-auto",children:[e.jsxs("div",{className:"max-w-4xl mx-auto pb-20",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("div",{className:"flex gap-4 overflow-x-auto",children:[e.jsx(_,{tab:"production",label:"ProducciÃ³n",icon:"cake-slice"}),e.jsx(_,{tab:"operations",label:"Usuarios",icon:"clipboard-kanban"}),e.jsx(_,{tab:"routines",label:"Rutinas",icon:"list"}),e.jsx(_,{tab:"inventory",label:"Inventario",icon:"archive"})]})}),e.jsxs("div",{className:"mt-6",children:[s==="production"&&e.jsxs("section",{className:"space-y-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Gestionar Recetas"}),e.jsxs("button",{onClick:ge,className:"flex items-center gap-2 bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors text-sm",children:[e.jsx(C,{name:"plus-circle",size:16}),"AÃ±adir Receta"]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-lg text-blue-700 mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ¥£"})," ElaboraciÃ³n de Masas"]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm",children:e.jsx("ul",{className:"divide-y divide-gray-200",children:se.length>0?se.map(a=>e.jsxs("li",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"font-medium text-gray-800",children:a.name}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>M(a),className:"text-sm text-gray-500 hover:text-blue-600 hover:underline font-semibold transition-colors",children:"Historial"}),e.jsx("button",{onClick:()=>X(a),className:"text-sm text-blue-600 hover:text-blue-800 hover:underline font-semibold transition-colors",children:"Editar"})]})]},a.id)):e.jsx("li",{className:"p-4 text-gray-400 italic text-sm text-center",children:"No hay recetas de masas configuradas."})})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-lg text-orange-700 mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ”¥"})," Horneado Final"]}),e.jsx("div",{className:"bg-white rounded-lg border border-orange-200 shadow-sm",children:e.jsx("ul",{className:"divide-y divide-orange-100",children:ee.length>0?ee.map(a=>e.jsxs("li",{className:"p-4 flex justify-between items-center bg-orange-50/30",children:[e.jsx("span",{className:"font-medium text-gray-800",children:a.name.replace(/\(Horneado\)/i,"").trim()}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>M(a),className:"text-sm text-gray-500 hover:text-blue-600 hover:underline font-semibold transition-colors",children:"Historial"}),e.jsx("button",{onClick:()=>X(a),className:"text-sm text-blue-600 hover:text-blue-800 hover:underline font-semibold transition-colors",children:"Editar"})]})]},a.id)):e.jsx("li",{className:"p-4 text-gray-400 italic text-sm text-center",children:"No hay recetas de horneado configuradas."})})})]})]}),s==="routines"&&e.jsx(Fe,{users:z}),s==="inventory"&&e.jsxs("div",{className:"space-y-8",children:[e.jsxs("section",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-blue-700",children:"Proveedores de Inventario"}),e.jsxs("button",{onClick:oe,className:"flex items-center gap-2 bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors text-sm",children:[e.jsx(C,{name:"plus-circle",size:16}),"AÃ±adir Proveedor"]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm",children:e.jsx("ul",{className:"divide-y divide-gray-200",children:b.length>0?b.map(a=>e.jsxs("li",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"font-medium text-gray-800",children:a.name}),e.jsx("button",{onClick:()=>ne(a),className:"text-sm text-blue-600 hover:underline font-semibold",children:"Editar"})]},a.id)):e.jsx("li",{className:"p-4 text-center text-gray-500",children:"No hay proveedores. Â¡AÃ±ade el primero!"})})})]}),e.jsxs("section",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-blue-700",children:"CategorÃ­as de Inventario"}),e.jsxs("button",{onClick:ce,className:"flex items-center gap-2 bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors text-sm",children:[e.jsx(C,{name:"plus-circle",size:16}),"AÃ±adir CategorÃ­a"]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm",children:e.jsx("ul",{className:"divide-y divide-gray-200",children:f.length>0?f.map(a=>e.jsxs("li",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"font-medium text-gray-800",children:a.name}),e.jsx("button",{onClick:()=>de(a),className:"text-sm text-blue-600 hover:underline font-semibold",children:"Editar"})]},a.id)):e.jsx("li",{className:"p-4 text-center text-gray-500",children:"No hay categorÃ­as. Â¡AÃ±ade la primera!"})})})]})]}),s==="operations"&&e.jsxs("section",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-blue-700",children:"GestiÃ³n de Usuarios"}),e.jsxs("button",{onClick:xe,className:"flex items-center gap-2 bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors text-sm",children:[e.jsx(C,{name:"plus-circle",size:16}),"AÃ±adir Usuario"]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm",children:e.jsx("ul",{className:"divide-y divide-gray-200",children:z.length>0?z.map(a=>e.jsxs("li",{className:"p-4 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-white shadow-sm",style:{backgroundColor:a.color}}),e.jsx("span",{className:"font-medium text-gray-800",children:a.name})]}),e.jsx("button",{onClick:()=>ue(a),className:"text-sm text-blue-600 hover:underline font-semibold",children:"Editar"})]},a.id)):e.jsx("li",{className:"p-4 text-center text-gray-500",children:"No hay usuarios. Â¡AÃ±ade el primero!"})})})]})]}),e.jsxs("div",{className:"mt-12 p-6 bg-white border-2 border-gray-200 rounded-xl shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(C,{name:"settings",className:"text-gray-600",size:24}),e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Mantenimiento de la App"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[e.jsx("h4",{className:"font-bold text-green-800 mb-2",children:"ðŸš‘ Reiniciar CronÃ³metros (Seguro)"}),e.jsxs("p",{className:"text-sm text-green-700 mb-4",children:["Usa esto si los cronÃ³metros de panaderÃ­a estÃ¡n trabados.",e.jsx("strong",{children:" NO borra datos."})]}),e.jsx("button",{onClick:pe,disabled:i,className:"w-full px-4 py-2 bg-green-600 text-white font-bold rounded-lg hover:bg-green-700 transition-colors shadow-sm disabled:opacity-50",children:i?"Reparando...":"Reiniciar CronÃ³metros"})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-bold text-blue-800 mb-2",children:"ðŸ¥£ Restaurar Recetas de FÃ¡brica"}),e.jsx("p",{className:"text-sm text-blue-700 mb-4",children:"Borra TODAS las recetas actuales y recarga las recetas estÃ¡ndar (Pizza, Croissants, etc.) limpias."}),e.jsx("button",{onClick:G,className:"w-full px-4 py-2 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 transition-colors shadow-sm",children:"Restaurar Recetas"})]}),e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-200",children:[e.jsx("h4",{className:"font-bold text-orange-800 mb-2",children:"ðŸ“… GestiÃ³n de Tareas"}),e.jsx("p",{className:"text-sm text-orange-700 mb-4",children:"Opciones para limpiar o reiniciar tu agenda de operaciones."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:fe,className:"flex-1 px-3 py-2 bg-orange-600 text-white font-bold rounded-lg hover:bg-orange-700 transition-colors shadow-sm text-xs",children:"Borrar Todo"}),e.jsx("button",{onClick:je,className:"flex-1 px-3 py-2 bg-white border border-orange-300 text-orange-700 font-bold rounded-lg hover:bg-orange-50 transition-colors shadow-sm text-xs",children:"Restaurar Default"})]})]})]})]})]}),e.jsx(Te,{isOpen:d,onClose:()=>u(!1),onSave:ie,onDelete:g,provider:p}),e.jsx(Pe,{isOpen:v,onClose:()=>R(!1),onSave:me,onDelete:V,category:T}),e.jsx(qe,{isOpen:J,onClose:()=>B(!1),onSave:be,onDelete:H,user:K}),e.jsx(Ve,{isOpen:E,onClose:()=>W(!1),onSave:he,onDelete:O,recipe:Z}),A&&e.jsx(ze,{isOpen:!!A,onClose:()=>M(null),recipe:A,feedbackLog:L.filter(a=>a.recipeId===A.id)})]})};export{He as default};
