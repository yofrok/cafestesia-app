import{j as e,R as I,I as x,r as h}from"./index-CEAhH_F_.js";import{M as C}from"./Modal-DDJzFDcp.js";const R=({isOpen:t,onClose:l,onSelectRecipe:s,onSelectHeating:c})=>{const n=o=>{s(o),l()},a=(o,i)=>{c(o,i),l()};return e.jsx(C,{isOpen:t,onClose:l,title:"Iniciar un Nuevo Proceso",children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-blue-700 mb-2",children:"Recetas de Horneado"}),e.jsx("div",{className:"flex flex-col gap-3",children:Object.values(I).map(o=>e.jsxs("button",{onClick:()=>n(o.id),className:"w-full p-4 bg-gray-100 text-gray-800 font-bold rounded-lg border border-gray-200 hover:bg-gray-200 hover:border-gray-300 transition-colors text-left",children:["Hornear ",o.name]},o.id))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-blue-700 mb-2",children:"Procesos de Calentamiento"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>a(15*60,"Precalentar (15 min)"),className:"w-full p-4 flex items-center justify-center gap-2 bg-gray-100 text-gray-800 font-bold rounded-lg border border-gray-200 hover:bg-gray-200 hover:border-gray-300 transition-colors",children:[e.jsx(x,{name:"thermometer-snowflake",size:20})," Precalentar"]}),e.jsxs("button",{onClick:()=>a(7*60,"Recalentar (7 min)"),className:"w-full p-4 flex items-center justify-center gap-2 bg-gray-100 text-gray-800 font-bold rounded-lg border border-gray-200 hover:bg-gray-200 hover:border-gray-300 transition-colors",children:[e.jsx(x,{name:"thermometer-sun",size:20})," Recalentar"]})]})]})]})})},k=t=>{(isNaN(t)||t<0)&&(t=0);const l=Math.floor(t/60),s=t%60;return`${String(l).padStart(2,"0")}:${String(s).padStart(2,"0")}`},A=({step:t,isCompleted:l,isCurrent:s})=>{let c="text-gray-500";return s&&(c="font-bold text-blue-700"),l&&(c="text-gray-400 line-through"),e.jsxs("div",{className:"flex items-start gap-3 py-2",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:l?e.jsx(x,{name:"check-circle",size:16,className:"text-green-500"}):e.jsx("div",{className:`w-4 h-4 rounded-full border-2 ${s?"border-blue-500 bg-blue-100":"border-gray-300"}`})}),e.jsx("p",{className:`text-sm ${c}`,children:t.instruction})]})},S=({process:t,onAdvance:l,onTogglePause:s,onCancel:c,onAcknowledgeFinish:n})=>{const{state:a,name:o,steps:i,currentStepIndex:g,totalTimeLeft:m,stepTimeLeft:f}=t,[d,u]=h.useState(!1),p=()=>{switch(a){case"running":return"border-green-500";case"alarm":return"border-red-500 animate-pulse-red";case"finished":return"border-blue-500";case"paused":return"border-gray-300";default:return"border-gray-300"}},j=()=>{switch(a){case"running":return"bg-green-100 text-green-800";case"alarm":return"bg-red-100 text-red-800";case"finished":return"bg-blue-100 text-blue-800";case"paused":return"bg-gray-100 text-gray-800";default:return"bg-gray-100"}},y=()=>{switch(a){case"paused":return e.jsx("button",{onClick:()=>s(t.id),className:"w-full bg-green-500 text-white font-bold py-3 rounded-lg hover:bg-green-600 transition-colors",children:"INICIAR"});case"running":return e.jsx("button",{onClick:()=>s(t.id),className:"w-full bg-yellow-500 text-white font-bold py-3 rounded-lg hover:bg-yellow-600 transition-colors",children:"PAUSAR"});case"alarm":return e.jsx("button",{onClick:()=>l(t.id),className:"w-full bg-blue-500 text-white font-bold py-3 rounded-lg hover:bg-blue-600 transition-colors animate-pulse",children:"SIGUIENTE PASO"});case"finished":return e.jsx("button",{onClick:()=>n(t),className:"w-full bg-gray-500 text-white font-bold py-3 rounded-lg hover:bg-gray-600 transition-colors",children:"LIMPIAR"})}};return d?e.jsxs("div",{className:"flex flex-col bg-white rounded-lg border-2 border-red-400 shadow-lg p-4 justify-center items-center text-center",children:[e.jsx("h4",{className:"font-bold text-lg mb-2 text-gray-800",children:"¿Estás seguro?"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Se perderá todo el progreso de este proceso."}),e.jsxs("div",{className:"flex gap-4 w-full",children:[e.jsx("button",{onClick:()=>u(!1),className:"flex-1 py-2 px-4 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300",children:"No, volver"}),e.jsx("button",{onClick:()=>c(t.id),className:"flex-1 py-2 px-4 bg-red-600 text-white font-semibold rounded-lg hover:bg-red-700",children:"Sí, cancelar"})]})]}):e.jsxs("div",{className:`flex flex-col bg-white rounded-lg border-2 shadow-sm ${p()}`,children:[e.jsx("header",{className:"p-3 rounded-t-md",children:e.jsx("h3",{className:`font-bold text-lg ${j().split(" ")[1]}`,children:o})}),e.jsxs("div",{className:"p-4 flex-grow flex flex-col justify-between",children:[e.jsxs("div",{className:"timers flex justify-around text-center mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500 uppercase font-bold",children:"Total Restante"}),e.jsx("p",{className:"text-3xl font-bold",children:k(m)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500 uppercase font-bold",children:"Paso Actual"}),e.jsx("p",{className:"text-3xl font-bold",children:k(f)})]})]}),e.jsxs("div",{className:"steps-list mb-4 p-3 bg-gray-50 rounded-lg max-h-40 overflow-y-auto border border-gray-200",children:[i.map((v,b)=>e.jsx(A,{step:v,isCompleted:b<g,isCurrent:b===g&&a!=="finished"},b)),a==="finished"&&e.jsxs("div",{className:"flex items-start gap-3 py-2 text-green-700 font-bold",children:[e.jsx(x,{name:"check-circle",size:16,className:"mt-1"}),e.jsx("p",{className:"text-sm",children:"¡Proceso completado!"})]})]}),e.jsxs("div",{className:"action-buttons space-y-2",children:[y(),a!=="finished"&&e.jsx("button",{onClick:()=>u(!0),className:"w-full text-center text-xs text-gray-500 hover:text-red-600 font-semibold py-1 transition-colors",children:"Cancelar Proceso"})]})]})]})},F=({rating:t,setRating:l})=>e.jsx("div",{className:"flex justify-center gap-2",children:[1,2,3,4,5].map(s=>e.jsx("button",{type:"button",onClick:()=>l(s),onMouseEnter:()=>{},onMouseLeave:()=>{},className:"transition-transform transform hover:scale-125",children:e.jsx(x,{name:"star",size:40,className:`cursor-pointer ${s<=t?"text-yellow-400 fill-current":"text-gray-300"}`})},s))}),M=({isOpen:t,processName:l,onSave:s,onSkip:c})=>{const[n,a]=h.useState(3),[o,i]=h.useState(""),g=()=>{s(n,o)};return e.jsx(C,{isOpen:t,onClose:c,title:`Feedback para: ${l}`,children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"¿Qué tal salió el resultado?"}),e.jsx(F,{rating:n,setRating:a})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"feedback-notes",className:"block text-sm font-medium text-gray-600 mb-1",children:"Notas (Opcional)"}),e.jsx("textarea",{id:"feedback-notes",value:o,onChange:m=>i(m.target.value),rows:4,placeholder:"Ej: El color fue perfecto, pero la próxima vez intentaré con 1 minuto menos...",className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsx("button",{type:"button",onClick:c,className:"py-2 px-4 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300",children:"Omitir"}),e.jsx("button",{type:"button",onClick:g,className:"py-2 px-6 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700",children:"Guardar"})]})]})})},O=({productionHook:t,recipeLogHook:l})=>{const[s,c]=h.useState(!1),[n,a]=h.useState(null),{processes:o,startBakingProcess:i,startHeatingProcess:g,advanceProcess:m,togglePauseProcess:f,cancelProcess:d,isSoundMuted:u,toggleSoundMute:p}=t,{addFeedback:j}=l,y=r=>{r.type==="baking"&&r.recipeId?a(r):d(r.id)},v=(r,P)=>{n&&n.recipeId&&(j({recipeId:n.recipeId,rating:r,notes:P}),d(n.id)),a(null)},b=()=>{n&&d(n.id),a(null)},N=o.filter(r=>r.state!=="finished"),w=o.filter(r=>r.state==="finished");return e.jsxs("div",{className:"p-4 md:p-6 h-full flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"text-xl font-bold text-blue-700",children:"Procesos Activos"}),e.jsx("button",{onClick:p,title:u?"Activar Sonidos":"Silenciar Sonidos",className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(x,{name:u?"volume-x":"volume-2",size:20})})]}),e.jsxs("button",{onClick:()=>c(!0),className:"flex items-center gap-2 bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors text-sm",children:[e.jsx(x,{name:"plus-circle",size:16}),"Iniciar Proceso"]})]}),e.jsxs("div",{className:"flex-grow overflow-y-auto",children:[N.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:N.map(r=>e.jsx(S,{process:r,onAdvance:m,onTogglePause:f,onCancel:d,onAcknowledgeFinish:()=>{}},r.id))}):e.jsxs("div",{className:"text-center py-16 text-gray-500",children:[e.jsx("p",{children:"No hay procesos activos en este momento."}),e.jsx("p",{children:'Haz clic en "Iniciar Proceso" para comenzar.'})]}),w.length>0&&e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-600",children:"Finalizados Recientemente"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-4",children:w.map(r=>e.jsx(S,{process:r,onAdvance:m,onTogglePause:()=>{},onCancel:d,onAcknowledgeFinish:()=>y(r)},r.id))})]})]}),e.jsx(R,{isOpen:s,onClose:()=>c(!1),onSelectRecipe:i,onSelectHeating:g}),n&&e.jsx(M,{isOpen:!!n,processName:n.name,onSave:v,onSkip:b})]})};export{O as default};
