import{j as e,R,I as g,r as b}from"./index-uUIEVMaR.js";import{M as P}from"./Modal-CGiVdZQ0.js";const A=({isOpen:t,onClose:a,onSelectRecipe:r,onSelectHeating:o})=>{const n=s=>{r(s),a()},i=(s,c)=>{o(s,c),a()};return e.jsx(P,{isOpen:t,onClose:a,title:"Iniciar un Nuevo Proceso",children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-blue-700 mb-2",children:"Recetas de Horneado"}),e.jsx("div",{className:"flex flex-col gap-3",children:Object.values(R).map(s=>e.jsxs("button",{onClick:()=>n(s.id),className:"w-full p-4 bg-gray-100 text-gray-800 font-bold rounded-lg border border-gray-200 hover:bg-gray-200 hover:border-gray-300 transition-colors text-left",children:["Hornear ",s.name]},s.id))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-blue-700 mb-2",children:"Procesos de Calentamiento"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>i(15*60,"Precalentar (15 min)"),className:"w-full p-4 flex items-center justify-center gap-2 bg-gray-100 text-gray-800 font-bold rounded-lg border border-gray-200 hover:bg-gray-200 hover:border-gray-300 transition-colors",children:[e.jsx(g,{name:"thermometer-snowflake",size:20})," Precalentar"]}),e.jsxs("button",{onClick:()=>i(7*60,"Recalentar (7 min)"),className:"w-full p-4 flex items-center justify-center gap-2 bg-gray-100 text-gray-800 font-bold rounded-lg border border-gray-200 hover:bg-gray-200 hover:border-gray-300 transition-colors",children:[e.jsx(g,{name:"thermometer-sun",size:20})," Recalentar"]})]})]})]})})},S=t=>{(isNaN(t)||t<0)&&(t=0);const a=Math.floor(t/60),r=t%60;return`${String(a).padStart(2,"0")}:${String(r).padStart(2,"0")}`},F=({step:t,isCompleted:a,isCurrent:r})=>{let o="text-gray-500";return r&&(o="font-bold text-blue-700"),a&&(o="text-gray-400 line-through"),e.jsxs("div",{className:"flex items-start gap-3 py-2",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:a?e.jsx(g,{name:"check-circle",size:16,className:"text-green-500"}):e.jsx("div",{className:`w-4 h-4 rounded-full border-2 ${r?"border-blue-500 bg-blue-100":"border-gray-300"}`})}),e.jsx("p",{className:`text-sm ${o}`,children:t.instruction})]})},C=({process:t,onAdvance:a,onTogglePause:r,onCancel:o,onAcknowledgeFinish:n,isAudioReady:i})=>{const{state:s,name:c,steps:m,currentStepIndex:d,totalTimeLeft:j,stepTimeLeft:x}=t,[h,f]=b.useState(!1),p=()=>{switch(s){case"running":return"border-green-500";case"alarm":return"border-red-500 animate-pulse-red";case"finished":return"border-blue-500";case"paused":return"border-gray-300";default:return"border-gray-300"}},y=()=>{switch(s){case"running":return"bg-green-100 text-green-800";case"alarm":return"bg-red-100 text-red-800";case"finished":return"bg-blue-100 text-blue-800";case"paused":return"bg-gray-100 text-gray-800";default:return"bg-gray-100"}},v=()=>{switch(s){case"paused":return e.jsx("button",{onClick:()=>r(t.id),disabled:!i,className:"w-full bg-green-500 text-white font-bold py-3 rounded-lg hover:bg-green-600 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:i?"INICIAR":"Cargando audio..."});case"running":return e.jsx("button",{onClick:()=>r(t.id),className:"w-full bg-yellow-500 text-white font-bold py-3 rounded-lg hover:bg-yellow-600 transition-colors",children:"PAUSAR"});case"alarm":return e.jsx("button",{onClick:()=>a(t.id),className:"w-full bg-blue-500 text-white font-bold py-3 rounded-lg hover:bg-blue-600 transition-colors animate-pulse",children:"SIGUIENTE PASO"});case"finished":return e.jsx("button",{onClick:()=>n(t),className:"w-full bg-gray-500 text-white font-bold py-3 rounded-lg hover:bg-gray-600 transition-colors",children:"LIMPIAR"})}};return h?e.jsxs("div",{className:"flex flex-col bg-white rounded-lg border-2 border-red-400 shadow-lg p-4 justify-center items-center text-center",children:[e.jsx("h4",{className:"font-bold text-lg mb-2 text-gray-800",children:"¿Estás seguro?"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Se perderá todo el progreso de este proceso."}),e.jsxs("div",{className:"flex gap-4 w-full",children:[e.jsx("button",{onClick:()=>f(!1),className:"flex-1 py-2 px-4 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300",children:"No, volver"}),e.jsx("button",{onClick:()=>o(t.id),className:"flex-1 py-2 px-4 bg-red-600 text-white font-semibold rounded-lg hover:bg-red-700",children:"Sí, cancelar"})]})]}):e.jsxs("div",{className:`flex flex-col bg-white rounded-lg border-2 shadow-sm ${p()}`,children:[e.jsx("header",{className:"p-3 rounded-t-md",children:e.jsx("h3",{className:`font-bold text-lg ${y().split(" ")[1]}`,children:c})}),e.jsxs("div",{className:"p-4 flex-grow flex flex-col justify-between",children:[e.jsxs("div",{className:"timers flex justify-around text-center mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500 uppercase font-bold",children:"Total Restante"}),e.jsx("p",{className:"text-3xl font-bold",children:S(j)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500 uppercase font-bold",children:"Paso Actual"}),e.jsx("p",{className:"text-3xl font-bold",children:S(x)})]})]}),e.jsxs("div",{className:"steps-list mb-4 p-3 bg-gray-50 rounded-lg max-h-40 overflow-y-auto border border-gray-200",children:[m.map((N,u)=>e.jsx(F,{step:N,isCompleted:u<d,isCurrent:u===d&&s!=="finished"},u)),s==="finished"&&e.jsxs("div",{className:"flex items-start gap-3 py-2 text-green-700 font-bold",children:[e.jsx(g,{name:"check-circle",size:16,className:"mt-1"}),e.jsx("p",{className:"text-sm",children:"¡Proceso completado!"})]})]}),e.jsxs("div",{className:"action-buttons space-y-2",children:[v(),s!=="finished"&&e.jsx("button",{onClick:()=>f(!0),className:"w-full text-center text-xs text-gray-500 hover:text-red-600 font-semibold py-1 transition-colors",children:"Cancelar Proceso"})]})]})]})},M=({rating:t,setRating:a})=>e.jsx("div",{className:"flex justify-center gap-2",children:[1,2,3,4,5].map(r=>e.jsx("button",{type:"button",onClick:()=>a(r),onMouseEnter:()=>{},onMouseLeave:()=>{},className:"transition-transform transform hover:scale-125",children:e.jsx(g,{name:"star",size:40,className:`cursor-pointer ${r<=t?"text-yellow-400 fill-current":"text-gray-300"}`})},r))}),z=({isOpen:t,processName:a,onSave:r,onSkip:o})=>{const[n,i]=b.useState(3),[s,c]=b.useState(""),m=()=>{r(n,s)};return e.jsx(P,{isOpen:t,onClose:o,title:`Feedback para: ${a}`,children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"¿Qué tal salió el resultado?"}),e.jsx(M,{rating:n,setRating:i})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"feedback-notes",className:"block text-sm font-medium text-gray-600 mb-1",children:"Notas (Opcional)"}),e.jsx("textarea",{id:"feedback-notes",value:s,onChange:d=>c(d.target.value),rows:4,placeholder:"Ej: El color fue perfecto, pero la próxima vez intentaré con 1 minuto menos...",className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsx("button",{type:"button",onClick:o,className:"py-2 px-4 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300",children:"Omitir"}),e.jsx("button",{type:"button",onClick:m,className:"py-2 px-6 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700",children:"Guardar"})]})]})})},$=({productionHook:t,recipeLogHook:a})=>{const[r,o]=b.useState(!1),[n,i]=b.useState(null),{processes:s,startBakingProcess:c,startHeatingProcess:m,advanceProcess:d,togglePauseProcess:j,cancelProcess:x,isSoundMuted:h,toggleSoundMute:f,isAudioReady:p}=t,{addFeedback:y}=a,v=l=>{l.type==="baking"&&l.recipeId?i(l):x(l.id)},N=(l,I)=>{n&&n.recipeId&&(y({recipeId:n.recipeId,rating:l,notes:I}),x(n.id)),i(null)},u=()=>{n&&x(n.id),i(null)},w=s.filter(l=>l.state!=="finished"),k=s.filter(l=>l.state==="finished");return e.jsxs("div",{className:"p-4 md:p-6 h-full flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"text-xl font-bold text-blue-700",children:"Procesos Activos"}),e.jsx("button",{onClick:f,title:h?"Activar Sonidos":"Silenciar Sonidos",className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(g,{name:h?"volume-x":"volume-2",size:20})})]}),e.jsxs("button",{onClick:()=>o(!0),className:"flex items-center gap-2 bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors text-sm",children:[e.jsx(g,{name:"plus-circle",size:16}),"Iniciar Proceso"]})]}),e.jsxs("div",{className:"flex-grow overflow-y-auto",children:[w.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:w.map(l=>e.jsx(C,{process:l,onAdvance:d,onTogglePause:j,onCancel:x,onAcknowledgeFinish:()=>{},isAudioReady:p},l.id))}):e.jsxs("div",{className:"text-center py-16 text-gray-500",children:[e.jsx("p",{children:"No hay procesos activos en este momento."}),e.jsx("p",{children:'Haz clic en "Iniciar Proceso" para comenzar.'})]}),k.length>0&&e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-600",children:"Finalizados Recientemente"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-4",children:k.map(l=>e.jsx(C,{process:l,onAdvance:d,onTogglePause:()=>{},onCancel:x,onAcknowledgeFinish:()=>v(l),isAudioReady:p},l.id))})]})]}),e.jsx(A,{isOpen:r,onClose:()=>o(!1),onSelectRecipe:c,onSelectHeating:m}),n&&e.jsx(z,{isOpen:!!n,processName:n.name,onSave:N,onSkip:u})]})};export{$ as default};
