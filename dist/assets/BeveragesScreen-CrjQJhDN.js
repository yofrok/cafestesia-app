import{r as d,j as e,I as x}from"./index-HV6JOfac.js";import{u as y}from"./useBeverages-CQCQ5Eas.js";import{M as N}from"./Modal-BsmTw2Od.js";import{S as O}from"./SwipeButton-TUpJM5Wq.js";const I=()=>{var j;const{beverages:l,createOrder:o}=y(),[m,n]=d.useState("caliente"),[t,r]=d.useState([]),[a,h]=d.useState(""),[c,g]=d.useState(null),v=["caliente","frio","metodo","otro"],p=l.filter(s=>s.category===m),w=s=>{s.hasSizes&&s.sizes&&s.sizes.length>0?g(s):f(s,void 0,s.recipe)},f=(s,i,b)=>{const z={id:`item-${Date.now()}`,beverageId:s.id,beverageName:s.name,sizeName:i,modifiers:[],recipeRef:b||s.recipe};r([...t,z]),g(null)},C=()=>{r(s=>s.slice(0,-1))},S=s=>{if(t.length===0)return;const i=[...t],b=i[i.length-1];b.modifiers.includes(s)||(b.modifiers.push(s),r(i))},k=()=>{if(t.length===0)return;const s=a.trim()||"Mostrador";o(s,t),h(""),r([])},u=Array.from(new Set(p.flatMap(s=>s.modifiers||[]))).slice(0,6);return e.jsxs("div",{className:"flex flex-col h-full md:flex-row overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col bg-gray-100 border-r border-gray-200",children:[e.jsx("div",{className:"flex gap-2 p-2 bg-white shadow-sm overflow-x-auto",children:v.map(s=>e.jsx("button",{onClick:()=>n(s),className:`px-4 py-3 rounded-lg font-bold capitalize flex-shrink-0 transition-colors ${m===s?"bg-amber-700 text-white":"bg-gray-100 text-gray-600"}`,children:s},s))}),e.jsx("div",{className:"p-4 grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 overflow-y-auto content-start",children:p.map(s=>e.jsxs("button",{onClick:()=>w(s),className:"bg-white p-4 h-24 rounded-xl shadow-sm border border-gray-200 hover:border-amber-500 hover:shadow-md transition-all flex flex-col items-center justify-center text-center active:scale-95 relative",children:[e.jsx("span",{className:"font-bold text-gray-800 leading-tight",children:s.name}),s.hasSizes&&e.jsx("span",{className:"absolute top-2 right-2 text-xs bg-gray-100 text-gray-500 px-1 rounded",children:"Tallas"})]},s.id))}),t.length>0&&u.length>0&&e.jsx("div",{className:"p-2 bg-gray-200 flex gap-2 overflow-x-auto",children:u.map(s=>e.jsxs("button",{onClick:()=>S(s),className:"px-3 py-2 bg-white rounded-full text-xs font-bold text-gray-700 border border-gray-300 shadow-sm hover:bg-blue-50 active:bg-blue-100 whitespace-nowrap",children:["+ ",s]},s))})]}),e.jsxs("div",{className:"w-full md:w-80 bg-white flex flex-col flex-shrink-0 border-l border-gray-200 shadow-xl z-10",children:[e.jsx("div",{className:"p-4 bg-gray-50 border-b border-gray-200",children:e.jsx("input",{type:"text",value:a,onChange:s=>h(s.target.value),placeholder:"Nombre / Mesa (Opcional)",className:"w-full p-2 border border-gray-300 rounded-md text-lg font-semibold"})}),e.jsx("div",{className:"flex-grow overflow-y-auto p-4 space-y-3",children:t.length===0?e.jsxs("div",{className:"text-center text-gray-400 mt-10",children:[e.jsx(x,{name:"shopping-cart",size:48,className:"mx-auto mb-2 opacity-20"}),e.jsx("p",{children:"Ticket vacío"})]}):t.map((s,i)=>e.jsx("div",{className:`flex justify-between items-start pb-2 border-b border-dashed border-gray-200 ${i===t.length-1?"opacity-100":"opacity-70"}`,children:e.jsxs("div",{children:[e.jsxs("p",{className:"font-bold text-gray-800",children:[s.beverageName,s.sizeName&&e.jsxs("span",{className:"text-amber-700 ml-1 text-sm",children:["(",s.sizeName,")"]})]}),s.modifiers.length>0&&e.jsx("p",{className:"text-xs text-blue-600",children:s.modifiers.join(", ")})]})},i))}),e.jsxs("div",{className:"p-4 bg-gray-50 border-t border-gray-200 grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:C,disabled:t.length===0,className:"py-3 bg-gray-200 text-gray-600 font-bold rounded-lg disabled:opacity-50",children:e.jsx(x,{name:"rotate-ccw",className:"mx-auto"})}),e.jsxs("button",{onClick:k,disabled:t.length===0,className:"py-3 bg-green-600 text-white font-bold rounded-lg hover:bg-green-700 shadow-md disabled:opacity-50 flex items-center justify-center gap-2",children:[e.jsx("span",{children:"ENVIAR"}),e.jsx(x,{name:"play-circle"})]})]})]}),c&&e.jsx(N,{isOpen:!!c,onClose:()=>g(null),title:`Tamaño para: ${c.name}`,children:e.jsxs("div",{className:"flex flex-col gap-3",children:[(j=c.sizes)==null?void 0:j.map((s,i)=>e.jsx("button",{onClick:()=>f(c,s.name,s.recipe),className:"p-4 bg-blue-50 border border-blue-200 rounded-xl text-blue-800 font-bold text-lg hover:bg-blue-100 transition-colors",children:s.name},i)),e.jsx("button",{onClick:()=>g(null),className:"p-3 mt-2 bg-gray-100 text-gray-600 rounded-lg font-semibold",children:"Cancelar"})]})})]})},B=({timestamp:l})=>{const[o,m]=d.useState(0);d.useEffect(()=>{const t=()=>m(Math.floor((Date.now()-l)/6e4));t();const r=setInterval(t,6e4);return()=>clearInterval(r)},[l]);let n="bg-green-100 text-green-800";return o>=5&&(n="bg-yellow-100 text-yellow-800"),o>=8&&(n="bg-red-100 text-red-800 animate-pulse"),e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-bold ${n}`,children:[o," min"]})},M=()=>{const{activeOrders:l,completeOrder:o,cancelOrder:m}=y(),[n,t]=d.useState(null);return e.jsxs("div",{className:"h-full overflow-y-auto p-4 bg-gray-100",children:[l.length===0?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-400",children:[e.jsx(x,{name:"check-circle",size:64,className:"mb-4 text-gray-300"}),e.jsx("p",{className:"text-xl font-bold",children:"Barra Limpia"}),e.jsx("p",{children:"Esperando pedidos..."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:l.map(r=>e.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-3 bg-gray-50 border-b border-gray-200 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg truncate max-w-[150px]",children:r.customerName}),e.jsxs("p",{className:"text-xs text-gray-500",children:["#",r.id.slice(-4)]})]}),e.jsx(B,{timestamp:r.createdAt})]}),e.jsx("div",{className:"p-4 flex-grow space-y-4",children:r.items.map((a,h)=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"mt-1",children:e.jsx("button",{onClick:()=>t({name:`${a.beverageName} ${a.sizeName?`(${a.sizeName})`:""}`,text:a.recipeRef||"Sin receta disponible."}),className:"text-amber-600 hover:bg-amber-50 p-1 rounded-full transition-colors",title:"Ver Receta",children:e.jsx(x,{name:"list",size:18})})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-bold text-gray-800 text-lg leading-tight",children:[a.beverageName,a.sizeName&&e.jsxs("span",{className:"text-amber-700 ml-1 text-base font-bold",children:["(",a.sizeName,")"]})]}),a.modifiers.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:a.modifiers.map((c,g)=>e.jsx("span",{className:"bg-blue-50 text-blue-700 px-2 py-0.5 rounded text-xs font-bold border border-blue-100",children:c},g))})]})]},h))}),e.jsxs("div",{className:"p-3 border-t border-gray-100 bg-gray-50",children:[e.jsx(O,{onSwipe:()=>o(r.id),text:"Completar",icon:"check",className:"bg-white border-gray-300 shadow-sm h-12"}),e.jsx("div",{className:"text-center mt-2",children:e.jsx("button",{onClick:()=>{confirm("Cancelar ticket?")&&m(r.id)},className:"text-xs text-gray-400 hover:text-red-500",children:"Cancelar"})})]})]},r.id))}),n&&e.jsxs(N,{isOpen:!!n,onClose:()=>t(null),title:n.name,children:[e.jsx("div",{className:"bg-amber-50 p-4 rounded-lg border border-amber-200 text-amber-900 whitespace-pre-wrap font-medium text-lg",children:n.text}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{onClick:()=>t(null),className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-bold shadow-md text-lg w-full",children:"¡Entendido!"})})]})]})},A=()=>{const[l,o]=d.useState("pos");return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("header",{className:"flex-shrink-0 bg-white border-b border-gray-200 p-2 flex justify-center gap-4",children:[e.jsxs("button",{onClick:()=>o("pos"),className:`flex items-center gap-2 px-6 py-2 rounded-full font-bold transition-all ${l==="pos"?"bg-amber-700 text-white shadow-md":"text-gray-500 hover:bg-gray-100"}`,children:[e.jsx(x,{name:"plus-circle",size:20}),"Comanda (POS)"]}),e.jsxs("button",{onClick:()=>o("kds"),className:`flex items-center gap-2 px-6 py-2 rounded-full font-bold transition-all ${l==="kds"?"bg-blue-600 text-white shadow-md":"text-gray-500 hover:bg-gray-100"}`,children:[e.jsx(x,{name:"list",size:20}),"Barra (KDS)"]})]}),e.jsx("div",{className:"flex-grow overflow-hidden relative",children:l==="pos"?e.jsx(I,{}):e.jsx(M,{})})]})};export{A as default};
